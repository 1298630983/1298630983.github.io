<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://yoursite.com">
  <title>Zhisheng的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Zhisheng的博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Zhisheng的博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Zhisheng的博客">
  
    <link rel="alternative" href="/atom.xml" title="Zhisheng的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  <link rel="stylesheet" type="text/css" href="/./main.234bc0.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/img/avatar.png" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">Zhisheng Tian</a></h1>
		</hgroup>
		
		<p class="header-subtitle">永远不要跟别人比幸运，我从来没想过我比别人幸运，我也许比他们更有毅力，在最困难的时候，他们熬不住了，我可以多熬一秒钟、两秒钟。</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/tags/随笔/">随笔</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友链</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/zhisheng17/" title="github"><i class="icon-github"></i></a>
		        
					<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/tian-zhisheng/activities" title="zhihu"><i class="icon-zhihu"></i></a>
		        
					<a class="jianshu" target="_blank" href="http://www.jianshu.com/u/419f65c24433" title="jianshu"><i class="icon-jianshu"></i></a>
		        
					<a class="segmentfault" target="_blank" href="https://segmentfault.com/u/yuanblog" title="segmentfault"><i class="icon-segmentfault"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/img/avatar.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">Zhisheng Tian</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>永远不要跟别人比幸运，我从来没想过我比别人幸运，我也许比他们更有毅力，在最困难的时候，他们熬不住了，我可以多熬一秒钟、两秒钟。<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/zhisheng17/" title="github"><i class="icon-github"></i></a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/tian-zhisheng/activities" title="zhihu"><i class="icon-zhihu"></i></a>
			        
						<a class="jianshu" target="_blank" href="http://www.jianshu.com/u/419f65c24433" title="jianshu"><i class="icon-jianshu"></i></a>
			        
						<a class="segmentfault" target="_blank" href="https://segmentfault.com/u/yuanblog" title="segmentfault"><i class="icon-segmentfault"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 50%">
				
				
					<li style="width: 50%"><a href="/">主页</a></li>
		        
					<li style="width: 50%"><a href="/tags/随笔/">随笔</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            
  
    <article id="post-解决jdk1.8中发送邮件失败（handshake_failure）问题" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>暑假在家做一个类似知乎的问答型网站（代码可见：<a href="https://github.com/1041218129/wenda" target="_blank" rel="external">Github/wenda</a>  喜欢的可以给个star或者自己fork然后修改，目前功能还未很完善），其中有一个<strong>站内邮件通知系统</strong>（这里简单的讲一个例子：如果用户登录的时候出现异常，那么就会通过邮件发送通知用户）。然而却碰到一个问题。问题错误信息如下：</p>
<blockquote>
<p>发送邮件失败Mail server connection failed;    nested exception is javax.mail.MessagingException:     Could not connect to SMTP host: smtp.qq.com, port: 465;</p>
<p>nested exception is:   javax.net.ssl.SSLHandshakeException: Received fatal alert: handshake_failure. Failed messages: javax.mail.  MessagingException: Could not connect to SMTP   host: smtp.qq.com,  port: 465;</p>
<p>nested exception is:  <strong>javax.net.ssl.SSLHandshakeException: Received fatal alert: handshake_failure</strong></p>
</blockquote>
<p>自己在将错误信息代码google了一下，找了很久发现很多解决方案，包括stackoverflow上的一些解决方案，但还是没用。然后呢用百度试了下，结果在第一条是开源中国的一篇博客:<a href="http://www.oschina.net/question/2282830_247657" target="_blank" rel="external">javax.net.ssl.SSLHandshakeException: Received fatal alert: handshake_failure</a>。<br><img src="http://img.blog.csdn.net/20160812214234823" alt="百度出来的结果"></p>
<p>点进去是这样的：（如下图）<br><img src="http://img.blog.csdn.net/20160812214501830" alt="开源中国"></p>
<p><img src="http://img.blog.csdn.net/20160812214625234" alt="正确解决方式"></p>
<p>结果就是：这个问题是jdk导致的，jdk1.8里面有一个jce的包，安全性机制导致的访问https会报错，官网上有替代的jar包，如果替换掉就可以了。问题的解决方法还可以就是在整个项目中把你的jdk换成是1.7去，同样也可以解决这个我问题。</p>
<p>这两个jar包的下载地址：<a href="http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html" target="_blank" rel="external">http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html</a></p>
<p><img src="http://img.blog.csdn.net/20160812215327071" alt="包下载"></p>
<p>然后下载之后，把这个压缩文件解压，得到两个jar包去覆盖jdk安装目录下的jre\lib\security\下相同的jar包就能解决java8的邮件发送问题。</p>
<p>接着用QQ邮箱我亲测有用，但是要注意一点就是：开启SMTP服务后要记得将你的16位授权码作为你的qq邮箱登录密码。</p>
<blockquote>
<p>MailSender.java中mailSender.setPassword(“16位授权码”);</p>
<p>mailSender.setHost(“smtp.qq.com”);<br>mailSender.setPort(465);</p>
</blockquote>
<p><img src="http://img.blog.csdn.net/20160812215943627" alt="开启服务注意的地方"></p>
<p><img src="http://img.blog.csdn.net/20160812220046041" alt="16位授权码"></p>
<p>下面把完整代码发布出来：</p>
<p> <strong>1. LoginExceptionHandler.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.nowcoder.async.handler;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.nowcoder.async.EventHandler;</div><div class="line"><span class="keyword">import</span> com.nowcoder.async.EventModel;</div><div class="line"><span class="keyword">import</span> com.nowcoder.async.EventType;</div><div class="line"><span class="keyword">import</span> com.nowcoder.util.MailSender;</div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</div><div class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Arrays;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by 10412 on 2016/8/10.</div><div class="line"> */</div><div class="line"><span class="meta">@Component</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginExceptionHandler</span> <span class="keyword">implements</span> <span class="title">EventHandler</span></span></div><div class="line">&#123;</div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    MailSender mailSender;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doHandle</span><span class="params">(EventModel model)</span> </span>&#123;</div><div class="line">        <span class="comment">// xxxx判断发现这个用户登陆异常</span></div><div class="line">        Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</div><div class="line">        map.put(<span class="string">"username"</span>, model.getExt(<span class="string">"username"</span>));</div><div class="line">        mailSender.sendWithHTMLTemplate(model.getExt(<span class="string">"email"</span>), <span class="string">"登陆IP异常"</span>, <span class="string">"mails/login_exception.html"</span>, map);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;EventType&gt; <span class="title">getSupportEventTypes</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> Arrays.asList(EventType.LOGIN);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> <strong>2. LoginController.java</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div></pre></td><td class="code"><pre><div class="line">package com.nowcoder.controller;</div><div class="line"></div><div class="line">import com.nowcoder.async.EventModel;</div><div class="line">import com.nowcoder.async.EventProducer;</div><div class="line">import com.nowcoder.async.EventType;</div><div class="line">import com.nowcoder.service.UserService;</div><div class="line">import org.apache.commons.lang.StringUtils;</div><div class="line">import org.slf4j.Logger;</div><div class="line">import org.slf4j.LoggerFactory;</div><div class="line">import org.springframework.beans.factory.annotation.Autowired;</div><div class="line">import org.springframework.stereotype.Controller;</div><div class="line">import org.springframework.ui.Model;</div><div class="line">import org.springframework.web.bind.annotation.CookieValue;</div><div class="line">import org.springframework.web.bind.annotation.RequestMapping;</div><div class="line">import org.springframework.web.bind.annotation.RequestMethod;</div><div class="line">import org.springframework.web.bind.annotation.RequestParam;</div><div class="line"></div><div class="line">import javax.servlet.http.Cookie;</div><div class="line">import javax.servlet.http.HttpServletResponse;</div><div class="line">import java.util.Map;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by 10412 on 2016/7/2.</div><div class="line"> */</div><div class="line"></div><div class="line">@Controller</div><div class="line">public class LoginController &#123;</div><div class="line">    private static final Logger logger = LoggerFactory.getLogger(LoginController.class);</div><div class="line"></div><div class="line">    @Autowired</div><div class="line">    UserService userService;</div><div class="line"></div><div class="line">    @Autowired</div><div class="line">    EventProducer eventProducer;</div><div class="line"></div><div class="line">    @RequestMapping(path = &#123;&quot;/reg/&quot;&#125;, method = &#123;RequestMethod.POST&#125;)</div><div class="line">    public String reg(Model model, @RequestParam(&quot;username&quot;) String username,</div><div class="line">                      @RequestParam(&quot;password&quot;) String password,</div><div class="line">                      @RequestParam(&quot;next&quot;) String next,</div><div class="line">                      @RequestParam(value=&quot;rememberme&quot;, defaultValue = &quot;false&quot;) boolean rememberme,</div><div class="line">                      HttpServletResponse response) &#123;</div><div class="line">        try &#123;</div><div class="line">            Map&lt;String, Object&gt; map = userService.register(username, password);</div><div class="line">            if (map.containsKey(&quot;ticket&quot;)) &#123;</div><div class="line">                Cookie cookie = new Cookie(&quot;ticket&quot;, map.get(&quot;ticket&quot;).toString());</div><div class="line">                cookie.setPath(&quot;/&quot;);</div><div class="line">                if (rememberme) &#123;</div><div class="line">                    cookie.setMaxAge(3600*24*5);</div><div class="line">                &#125;</div><div class="line">                response.addCookie(cookie);</div><div class="line">                if (StringUtils.isNotBlank(next)) &#123;</div><div class="line">                    return &quot;redirect:&quot; + next;</div><div class="line">                &#125;</div><div class="line">                return &quot;redirect:/&quot;;</div><div class="line">            &#125; else &#123;</div><div class="line">                model.addAttribute(&quot;msg&quot;, map.get(&quot;msg&quot;));</div><div class="line">                return &quot;login&quot;;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            logger.error(&quot;注册异常&quot; + e.getMessage());</div><div class="line">            model.addAttribute(&quot;msg&quot;, &quot;服务器错误&quot;);</div><div class="line">            return &quot;login&quot;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @RequestMapping(path = &#123;&quot;/reglogin&quot;&#125;, method = &#123;RequestMethod.GET&#125;)</div><div class="line">    public String regloginPage(Model model, @RequestParam(value = &quot;next&quot;, required = false) String next) &#123;</div><div class="line">        model.addAttribute(&quot;next&quot;, next);</div><div class="line">        return &quot;login&quot;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @RequestMapping(path = &#123;&quot;/login/&quot;&#125;, method = &#123;RequestMethod.POST&#125;)</div><div class="line">    public String login(Model model, @RequestParam(&quot;username&quot;) String username,</div><div class="line">                        @RequestParam(&quot;password&quot;) String password,</div><div class="line">                        @RequestParam(value=&quot;next&quot;, required = false) String next,</div><div class="line">                        @RequestParam(value=&quot;rememberme&quot;, defaultValue = &quot;false&quot;) boolean rememberme,</div><div class="line">                        HttpServletResponse response) &#123;</div><div class="line">        try &#123;</div><div class="line">            Map&lt;String, Object&gt; map = userService.login(username, password);</div><div class="line">            if (map.containsKey(&quot;ticket&quot;)) &#123;</div><div class="line">                Cookie cookie = new Cookie(&quot;ticket&quot;, map.get(&quot;ticket&quot;).toString());</div><div class="line">                cookie.setPath(&quot;/&quot;);</div><div class="line">                if (rememberme) &#123;</div><div class="line">                    cookie.setMaxAge(3600*24*5);</div><div class="line">                &#125;</div><div class="line">                response.addCookie(cookie);</div><div class="line"></div><div class="line">                eventProducer.fireEvent(new EventModel(EventType.LOGIN)</div><div class="line">                        .setExt(&quot;username&quot;, username).setExt(&quot;email&quot;, &quot;****@qq.com&quot;)</div><div class="line">                        .setActorId((int)map.get(&quot;userId&quot;)));</div><div class="line"></div><div class="line">                if (StringUtils.isNotBlank(next)) &#123;</div><div class="line">                    return &quot;redirect:&quot; + next;</div><div class="line">                &#125;</div><div class="line">                return &quot;redirect:/&quot;;</div><div class="line">            &#125; else &#123;</div><div class="line">                model.addAttribute(&quot;msg&quot;, map.get(&quot;msg&quot;));</div><div class="line">                return &quot;login&quot;;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            logger.error(&quot;登陆异常&quot; + e.getMessage());</div><div class="line">            return &quot;login&quot;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @RequestMapping(path = &#123;&quot;/logout&quot;&#125;, method = &#123;RequestMethod.GET, RequestMethod.POST&#125;)</div><div class="line">    public String logout(@CookieValue(&quot;ticket&quot;) String ticket) &#123;</div><div class="line">        userService.logout(ticket);</div><div class="line">        return &quot;redirect:/&quot;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p> <strong>3. EventHandler.java</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">package com.nowcoder.async;</div><div class="line"></div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by 10412 on 2016/8/10.</div><div class="line"> */</div><div class="line">public interface EventHandler</div><div class="line">&#123;</div><div class="line">    void doHandle(EventModel model);</div><div class="line"></div><div class="line">    List&lt;EventType&gt; getSupportEventTypes();</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p> <strong>4. MailSender.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.nowcoder.util;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.apache.velocity.app.VelocityEngine;</div><div class="line"><span class="keyword">import</span> org.slf4j.Logger;</div><div class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.InitializingBean;</div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</div><div class="line"><span class="keyword">import</span> org.springframework.mail.javamail.JavaMailSenderImpl;</div><div class="line"><span class="keyword">import</span> org.springframework.mail.javamail.MimeMessageHelper;</div><div class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</div><div class="line"><span class="keyword">import</span> org.springframework.ui.velocity.VelocityEngineUtils;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.mail.internet.InternetAddress;</div><div class="line"><span class="keyword">import</span> javax.mail.internet.MimeMessage;</div><div class="line"><span class="keyword">import</span> javax.mail.internet.MimeUtility;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"><span class="keyword">import</span> java.util.Properties;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by 10412 on 2016/8/10. // ***<span class="doctag">@qq</span>.com   wnppafhsbrcgbfbh（16位授权码）</div><div class="line"> */</div><div class="line"><span class="meta">@Service</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MailSender</span> <span class="keyword">implements</span> <span class="title">InitializingBean</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(MailSender.class);</div><div class="line">    <span class="keyword">private</span> JavaMailSenderImpl mailSender;</div><div class="line"></div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    <span class="keyword">private</span> VelocityEngine velocityEngine;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">sendWithHTMLTemplate</span><span class="params">(String to, String subject, String template, Map&lt;String, Object&gt; model)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            String nick = MimeUtility.encodeText(<span class="string">"***"</span>);</div><div class="line">            InternetAddress from = <span class="keyword">new</span> InternetAddress(nick + <span class="string">"&lt;****@qq.com&gt;"</span>);</div><div class="line">            MimeMessage mimeMessage = mailSender.createMimeMessage();</div><div class="line">            MimeMessageHelper mimeMessageHelper = <span class="keyword">new</span> MimeMessageHelper(mimeMessage);</div><div class="line">            String result = VelocityEngineUtils</div><div class="line">                    .mergeTemplateIntoString(velocityEngine, template, <span class="string">"UTF-8"</span>, model);</div><div class="line">            mimeMessageHelper.setTo(to);</div><div class="line">            mimeMessageHelper.setFrom(from);</div><div class="line">            mimeMessageHelper.setSubject(subject);</div><div class="line">            mimeMessageHelper.setText(result, <span class="keyword">true</span>);</div><div class="line">            mailSender.send(mimeMessage);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">            logger.error(<span class="string">"发送邮件失败"</span> + e.getMessage());</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        mailSender = <span class="keyword">new</span> JavaMailSenderImpl();</div><div class="line">        mailSender.setUsername(<span class="string">"***@qq.com"</span>);</div><div class="line">        mailSender.setPassword(<span class="string">"wnppafhsbrcgbfbh"</span>);   <span class="comment">//qq邮箱开启smtp服务后使用16位授权码在第三方登录</span></div><div class="line"><span class="comment">//        mailSender.setHost("smtp.exmail.qq.com");</span></div><div class="line">        mailSender.setHost(<span class="string">"smtp.qq.com"</span>);</div><div class="line">        mailSender.setPort(<span class="number">465</span>);</div><div class="line"></div><div class="line"><span class="comment">//        mailSender.setHost("smtp.163.com");      //163邮箱</span></div><div class="line"><span class="comment">//        mailSender.setPort(25);</span></div><div class="line">        mailSender.setProtocol(<span class="string">"smtps"</span>);</div><div class="line">        mailSender.setDefaultEncoding(<span class="string">"utf8"</span>);</div><div class="line">        Properties javaMailProperties = <span class="keyword">new</span> Properties();</div><div class="line">        javaMailProperties.put(<span class="string">"mail.smtp.ssl.enable"</span>, <span class="keyword">true</span>);</div><div class="line">        <span class="comment">//javaMailProperties.put("mail.smtp.auth", true);</span></div><div class="line">        <span class="comment">//javaMailProperties.put("mail.smtp.starttls.enable", true);</span></div><div class="line">        mailSender.setJavaMailProperties(javaMailProperties);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> <strong>5. login_exception.html</strong>  发送消息模板（可自定义）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">你好$username，你的登陆有问题!</div></pre></td></tr></table></figure>
<p>一切都好了，运行。</p>
<p>登录。</p>
<p>发送邮件过来了。</p>
<p><img src="http://img.blog.csdn.net/20160812222233971" alt="邮件发过来了"></p>
<p>总结来说：<strong>这个错误就是jdk1.8中的一个jce的包，安全性机制导致访问https会报错。</strong></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/28/解决jdk1.8中发送邮件失败（handshake_failure）问题/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-循环队列的相关条件和公式" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/28/循环队列的相关条件和公式/">循环队列的相关条件和公式</a>
    </h1>
  

        
        <a href="/2017/03/28/循环队列的相关条件和公式/" class="archive-article-date">
  	<time datetime="2017-03-28T11:00:11.318Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-28</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>循环队列的相关条件和公式：</strong><br>队尾指针是rear,队头是front，其中QueueSize为循环队列的最大长度</p>
<ol>
<li>队空条件：rear==front</li>
<li>队满条件：(rear+1) %QueueSIze==front</li>
<li>计算队列长度：（rear-front+QueueSize）%QueueSize</li>
<li>入队：（rear+1）%QueueSize</li>
<li>出队：（front+1）%QueueSize</li>
<li>队列中元素的个数： (rear-front+QueueSize)%QueueSize</li>
</ol>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">数据结构</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">算法</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">循环队列</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/28/循环队列的相关条件和公式/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-Python爬虫实战之爬取糗事百科段子" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/28/Python爬虫实战之爬取糗事百科段子/">Python爬虫实战之爬取糗事百科段子</a>
    </h1>
  

        
        <a href="/2017/03/28/Python爬虫实战之爬取糗事百科段子/" class="archive-article-date">
  	<time datetime="2017-03-28T10:59:16.278Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-28</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="完整代码地址：Python爬虫实战之爬取糗事百科段子"><a href="#完整代码地址：Python爬虫实战之爬取糗事百科段子" class="headerlink" title="完整代码地址：Python爬虫实战之爬取糗事百科段子"></a>完整代码地址：<a href="https://github.com/zhisheng17/Python-Projects/tree/master/qiushibaike">Python爬虫实战之爬取糗事百科段子</a></h3><h3 id="程序代码详解："><a href="#程序代码详解：" class="headerlink" title="程序代码详解："></a><strong>程序代码详解：</strong></h3><ol>
<li><p><strong>Spider1-qiushibaike.py</strong>：爬取糗事百科的8小时最新页的段子。包含的信息有作者名称，觉得好笑人数，评论人数，发布的内容。如果发布的内容中含有图片的话，则过滤图片，内容依然显示出来。</p>
</li>
<li><p><strong>Spider2-qiushibaike.py</strong>：在Spider1-qiushibaike.py基础上，引入类和方法，进行优化和封装，爬取糗事百科的24小时热门页的段子。进一步优化，每按一次回车更新一条内容，当前页的内容抓取完毕后，自动抓取下一页的内容，按‘q’退出。</p>
</li>
<li><p><strong>Spider3-qiushibaike.py</strong>：在Spiders-qiushibaike.py基础上，爬取了百科段子的评论。按C查看当前这个糗事的评论，当切换到查看评论时，换回车显示下一个评论,按Q退出回到查看糗事。糗事段子页数是一页一页加载的，如果你已经看完所有的糗事，就会自动退出！</p>
</li>
</ol>
        
          <a class="article-more-a" href="/2017/03/28/Python爬虫实战之爬取糗事百科段子/#more">more >></a>
        
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">Python</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">爬虫</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/28/Python爬虫实战之爬取糗事百科段子/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-Python爬虫实战之爬取百度贴吧帖子" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/28/Python爬虫实战之爬取百度贴吧帖子/">Python爬虫实战之爬取百度贴吧帖子</a>
    </h1>
  

        
        <a href="/2017/03/28/Python爬虫实战之爬取百度贴吧帖子/" class="archive-article-date">
  	<time datetime="2017-03-28T10:58:38.918Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-28</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>大家好，上次我们实验了爬取了<a href="https://github.com/zhisheng17/Python-Projects/tree/master/qiushibaike" target="_blank" rel="external">糗事百科的段子</a>，那么这次我们来尝试一下爬取百度贴吧的帖子。与上一篇不同的是，这次我们需要用到文件的相关操作。</p>
<h3 id="本篇目标"><a href="#本篇目标" class="headerlink" title="本篇目标"></a><strong>本篇目标</strong></h3><ol>
<li><p>对百度贴吧的任意帖子进行抓取</p>
</li>
<li><p>指定是否只抓取楼主发帖内容</p>
</li>
<li><p>将抓取到的内容分析并保存到文件</p>
</li>
</ol>
<h3 id="1-URL格式的确定"><a href="#1-URL格式的确定" class="headerlink" title="1. URL格式的确定"></a><strong>1. URL格式的确定</strong></h3><p>首先，我们先观察一下百度贴吧的任意一个帖子。</p>
<p>比如：<a href="http://tieba.baidu.com/p/3138733512?see_lz=1&amp;pn=1，这是一个关于NBA50大的盘点，分析一下这个地址。" target="_blank" rel="external">http://tieba.baidu.com/p/3138733512?see_lz=1&amp;pn=1，这是一个关于NBA50大的盘点，分析一下这个地址。</a></p>
<blockquote>
<p> <code>http://</code>  代表资源传输使用http协议<br>  <figure class="highlight plain"><figcaption><span>是百度的二级域名，指向百度贴吧的服务器。</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt;   ```/p/3138733512``` 是服务器某个资源，即这个帖子的地址定位符</div><div class="line">&gt;   ```see_lz```和```pn```是该```URL```的两个参数，分别代表了只看楼主和帖子页码，等于1表示该条件为真</div><div class="line"></div><div class="line"></div><div class="line">所以我们可以把URL分为两部分，一部分为基础部分，一部分为参数部分。</div><div class="line"></div><div class="line">例如，上面的URL我们划分基础部分是 http://tieba.baidu.com/p/3138733512，参数部分是 ?see_lz=1&amp;pn=1</div><div class="line">&lt;!-- more --&gt;</div><div class="line">### **2. 页面的抓取**</div><div class="line"></div><div class="line">熟悉了URL的格式，那就让我们用urllib2库来试着抓取页面内容吧。上一篇糗事百科我们最后改成了面向对象的编码方式，这次我们直接尝试一下，定义一个类名叫BDTB(百度贴吧)，一个初始化方法，一个获取页面的方法。</div><div class="line"></div><div class="line">其中，有些帖子我们想指定给程序是否要只看楼主，所以我们把只看楼主的参数初始化放在类的初始化上，即init方法。另外，获取页面的方法我们需要知道一个参数就是帖子页码，所以这个参数的指定我们放在该方法中。</div><div class="line"></div><div class="line">综上，我们初步构建出基础代码如下：</div></pre></td></tr></table></figure></p>
</blockquote>
<p>#-<em>-coding:utf8-</em>-</p>
<p>#created by 10412<br>import urllib<br>import urllib2<br>import re</p>
<p>#百度贴吧爬虫类<br>class BDTB:</p>
<pre><code>#初始化，传入基地址，是否只看楼主的参数
def __init__(self, baseUrl, seeLZ):
    self.baseURL = baseUrl
    self.seeLZ = &apos;?see_lz=&apos; + str(seeLZ)

#传入页码，获取该页帖子的代码
def getPage(self, pageNum):
    try:
        url = self.baseURL + self.seeLZ + &apos;&amp;pn=&apos; + str(pageNum)
        request = urllib2.Request(url)
        response = urllib2.urlopen(request)
        print response.read()
        return response
    except urllib2.URLError, e:
        if hasattr(e, &quot;reason&quot;):
            print u&quot;连接百度贴吧失败,错误原因&quot;,e.reason
            return None
</code></pre><p>baseURL = ‘<a href="http://tieba.baidu.com/p/3138733512" target="_blank" rel="external">http://tieba.baidu.com/p/3138733512</a>‘<br>bdtb = BDTB(baseURL, 1)<br>bdtb.getPage(1)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">运行代码，我们可以看到屏幕上打印出了这个帖子第一页楼主发言的所有内容，形式为HTML代码。</div><div class="line"></div><div class="line"> ![这里写图片描述](http://img.blog.csdn.net/20160928085851899)</div><div class="line"></div><div class="line">### **3. 提取相关信息**</div><div class="line"></div><div class="line">#### 1)提取帖子标题</div><div class="line"></div><div class="line">在浏览器中审查元素，或者按F12，查看页面源代码，我们找到标题所在的代码段如下:</div><div class="line"></div><div class="line">```html</div><div class="line">&lt;h3 class=&quot;core_title_txt pull-left text-overflow  &quot; title=&quot;纯原创我心中的NBA2014-2015赛季现役50大&quot; style=&quot;width: 416px&quot;&gt;纯原创我心中的NBA2014-2015赛季现役50大&lt;/h3&gt;</div></pre></td></tr></table></figure></p>
<p>所以我们要提取<code>&lt;h3&gt;</code>中的内容，因为一开始可以查看整个界面的原代码，查看里面含有<code>&lt;h3&gt;</code>标签的不止一个。所以需要写正则表达式来匹配，如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;h3 class="core_title_txt.*?&gt;(.*?)&lt;/h3&gt;</div></pre></td></tr></table></figure>
<p>然后，我们可以写个获取标题的方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 获取帖子标题</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getTitle</span><span class="params">(self)</span>:</span></div><div class="line">        page = self.getPage(<span class="number">1</span>)</div><div class="line">        pattern = re.compile(<span class="string">'&lt;h3 class="core_title_txt.*?&gt;(.*?)&lt;/h3&gt;'</span>, re.S)</div><div class="line">        result = re.search(pattern, page)</div><div class="line">        <span class="keyword">if</span> result:</div><div class="line">            <span class="comment"># print result.group(1)  #测试输出</span></div><div class="line">            <span class="keyword">return</span> result.group(<span class="number">1</span>).strip()</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span></div></pre></td></tr></table></figure>
<h4 id="2）提取帖子页数"><a href="#2）提取帖子页数" class="headerlink" title="2）提取帖子页数"></a>2）提取帖子页数</h4><p>同样地，帖子总页数我们也可以通过分析页面中的共?页来获取。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"l_reply_num"</span> <span class="attr">style</span>=<span class="string">"margin-left:8px"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"red"</span> <span class="attr">style</span>=<span class="string">"margin-right:3px"</span>&gt;</span>4784<span class="tag">&lt;/<span class="name">span</span>&gt;</span>回复贴，共<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"red"</span>&gt;</span>36<span class="tag">&lt;/<span class="name">span</span>&gt;</span>页<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div></pre></td></tr></table></figure>
<p>所以我们的获取总页数的方法如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#获取帖子一共有多少页</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getPageNum</span><span class="params">(self)</span>:</span></div><div class="line">    page = self.getPage(<span class="number">1</span>)</div><div class="line">    pattern = re.compile(<span class="string">'&lt;li class="l_reply_num.*?&lt;/span&gt;.*?&lt;span.*?&gt;(.*?)&lt;/span&gt;'</span>,re.S)</div><div class="line">    result = re.search(pattern,page)</div><div class="line">    <span class="keyword">if</span> result:</div><div class="line">        <span class="comment">#print result.group(1)  #测试输出</span></div><div class="line">        <span class="keyword">return</span> result.group(<span class="number">1</span>).strip()</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span></div></pre></td></tr></table></figure>
<h4 id="3）提取正文内容"><a href="#3）提取正文内容" class="headerlink" title="3）提取正文内容"></a>3）提取正文内容</h4><p>审查元素，可以看到百度贴吧每一层楼的主要内容都在<div id="”post_content_xxxx”"></div>标签里面，所以我们可以写如下的正则表达式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div id=<span class="string">"post_content_.*?&gt;(.*?)&lt;/div&gt;</span></div></pre></td></tr></table></figure>
<p>所以提取正文内容的方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#获取每一层楼的内容,传入页面内容</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getContent</span><span class="params">(self,page)</span>:</span></div><div class="line">    pattern = re.compile(<span class="string">'&lt;div id="post_content_.*?&gt;(.*?)&lt;/div&gt;'</span>,re.S)</div><div class="line">    items = re.findall(pattern,page)</div><div class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> items:</div><div class="line">        <span class="keyword">print</span> item</div></pre></td></tr></table></figure>
<p>运行截图如下：</p>
<p><img src="http://img.blog.csdn.net/20160928085921774" alt="这里写图片描述"></p>
<p>可以看到有很多的换行符和图片符，既然出现这样的情况，那肯定不是我们想要的结果。那我们就必须要将文本进行处理，将各种复杂的标签给剔除，还原帖子的原来面貌。可以使用一个方法或者类将这个处理文本的实现，不过为了更好的代码重用和架构，还是建议使用一个类。</p>
<p>我们将这个类命名为<code>Too</code>（工具类），里面定义一个<code>replace</code>方法，替换各种标签。然后在类中定义几个正则表达式，利用<code>re.sub</code>方法对文本进行匹配后然后替换。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line"><span class="comment">#处理页面标签类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tool</span>:</span></div><div class="line">    <span class="comment">#去除img标签,7位长空格</span></div><div class="line">    removeImg = re.compile(<span class="string">'&lt;img.*?&gt;| &#123;7&#125;|'</span>)</div><div class="line">    <span class="comment">#删除超链接标签</span></div><div class="line">    removeAddr = re.compile(<span class="string">'&lt;a.*?&gt;|&lt;/a&gt;'</span>)</div><div class="line">    <span class="comment">#把换行的标签换为\n</span></div><div class="line">    replaceLine = re.compile(<span class="string">'&lt;tr&gt;|&lt;div&gt;|&lt;/div&gt;|&lt;/p&gt;'</span>)</div><div class="line">    <span class="comment">#将表格制表&lt;td&gt;替换为\t</span></div><div class="line">    replaceTD= re.compile(<span class="string">'&lt;td&gt;'</span>)</div><div class="line">    <span class="comment">#把段落开头换为\n加空两格</span></div><div class="line">    replacePara = re.compile(<span class="string">'&lt;p.*?&gt;'</span>)</div><div class="line">    <span class="comment">#将换行符或双换行符替换为\n</span></div><div class="line">    replaceBR = re.compile(<span class="string">'&lt;br&gt;&lt;br&gt;|&lt;br&gt;'</span>)</div><div class="line">    <span class="comment">#将其余标签剔除</span></div><div class="line">    removeExtraTag = re.compile(<span class="string">'&lt;.*?&gt;'</span>)</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">replace</span><span class="params">(self,x)</span>:</span></div><div class="line">        x = re.sub(self.removeImg,<span class="string">""</span>,x)</div><div class="line">        x = re.sub(self.removeAddr,<span class="string">""</span>,x)</div><div class="line">        x = re.sub(self.replaceLine,<span class="string">"\n"</span>,x)</div><div class="line">        x = re.sub(self.replaceTD,<span class="string">"\t"</span>,x)</div><div class="line">        x = re.sub(self.replacePara,<span class="string">"\n    "</span>,x)</div><div class="line">        x = re.sub(self.replaceBR,<span class="string">"\n"</span>,x)</div><div class="line">        x = re.sub(self.removeExtraTag,<span class="string">""</span>,x)</div><div class="line">        <span class="comment">#strip()将前后多余内容删除</span></div><div class="line">        <span class="keyword">return</span> x.strip()</div></pre></td></tr></table></figure>
<p>在使用时，我们只需要初始化一下这个类，然后调用replace方法即可。</p>
<p>现在整体代码是如下这样子的，现在我的代码是写到这样子的:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#-*-coding:utf8-*-</span></div><div class="line"><span class="comment">#created by 10412</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> urllib</div><div class="line"><span class="keyword">import</span> urllib2</div><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># 处理页面标签类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tool</span>:</span></div><div class="line">    <span class="comment"># 去除img标签,7位长空格</span></div><div class="line">    removeImg = re.compile(<span class="string">'&lt;img.*?&gt;| &#123;7&#125;|'</span>)</div><div class="line">    <span class="comment"># 删除超链接标签</span></div><div class="line">    removeAddr = re.compile(<span class="string">'&lt;a.*?&gt;|&lt;/a&gt;'</span>)</div><div class="line">    <span class="comment"># 把换行的标签换为\n</span></div><div class="line">    replaceLine = re.compile(<span class="string">'&lt;tr&gt;|&lt;div&gt;|&lt;/div&gt;|&lt;/p&gt;'</span>)</div><div class="line">    <span class="comment"># 将表格制表&lt;td&gt;替换为\t</span></div><div class="line">    replaceTD = re.compile(<span class="string">'&lt;td&gt;'</span>)</div><div class="line">    <span class="comment"># 把段落开头换为\n加空两格</span></div><div class="line">    replacePara = re.compile(<span class="string">'&lt;p.*?&gt;'</span>)</div><div class="line">    <span class="comment"># 将换行符或双换行符替换为\n</span></div><div class="line">    replaceBR = re.compile(<span class="string">'&lt;br&gt;&lt;br&gt;|&lt;br&gt;'</span>)</div><div class="line">    <span class="comment"># 将其余标签剔除</span></div><div class="line">    removeExtraTag = re.compile(<span class="string">'&lt;.*?&gt;'</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">replace</span><span class="params">(self, x)</span>:</span></div><div class="line">        x = re.sub(self.removeImg, <span class="string">""</span>, x)</div><div class="line">        x = re.sub(self.removeAddr, <span class="string">""</span>, x)</div><div class="line">        x = re.sub(self.replaceLine, <span class="string">"\n"</span>, x)</div><div class="line">        x = re.sub(self.replaceTD, <span class="string">"\t"</span>, x)</div><div class="line">        x = re.sub(self.replacePara, <span class="string">"\n    "</span>, x)</div><div class="line">        x = re.sub(self.replaceBR, <span class="string">"\n"</span>, x)</div><div class="line">        x = re.sub(self.removeExtraTag, <span class="string">""</span>, x)</div><div class="line">        <span class="comment"># strip()将前后多余内容删除</span></div><div class="line">        <span class="keyword">return</span> x.strip()</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># 百度贴吧爬虫类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BDTB</span>:</span></div><div class="line">    <span class="comment"># 初始化，传入基地址，是否只看楼主的参数</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, baseUrl, seeLZ)</span>:</span></div><div class="line">        self.baseURL = baseUrl</div><div class="line">        self.seeLZ = <span class="string">'?see_lz='</span> + str(seeLZ)</div><div class="line">        self.tool = Tool()</div><div class="line"></div><div class="line">    <span class="comment"># 传入页码，获取该页帖子的代码</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getPage</span><span class="params">(self, pageNum)</span>:</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            url = self.baseURL + self.seeLZ + <span class="string">'&amp;pn='</span> + str(pageNum)</div><div class="line">            request = urllib2.Request(url)</div><div class="line">            response = urllib2.urlopen(request)</div><div class="line">            <span class="keyword">return</span> response.read().decode(<span class="string">'utf-8'</span>)</div><div class="line">        <span class="keyword">except</span> urllib2.URLError, e:</div><div class="line">            <span class="keyword">if</span> hasattr(e, <span class="string">"reason"</span>):</div><div class="line">                <span class="keyword">print</span> <span class="string">u"连接百度贴吧失败,错误原因"</span>, e.reason</div><div class="line">                <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="comment"># 获取帖子标题</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getTitle</span><span class="params">(self)</span>:</span></div><div class="line">        page = self.getPage(<span class="number">1</span>)</div><div class="line">        pattern = re.compile(<span class="string">'&lt;h1 class="core_title_txt.*?&gt;(.*?)&lt;/h1&gt;'</span>, re.S)</div><div class="line">        result = re.search(pattern, page)</div><div class="line">        <span class="keyword">if</span> result:</div><div class="line">            <span class="comment"># print result.group(1)  #测试输出</span></div><div class="line">            <span class="keyword">return</span> result.group(<span class="number">1</span>).strip()</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="comment"># 获取帖子一共有多少页</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getPageNum</span><span class="params">(self)</span>:</span></div><div class="line">        page = self.getPage(<span class="number">1</span>)</div><div class="line">        pattern = re.compile(<span class="string">'&lt;li class="l_reply_num.*?&lt;/span&gt;.*?&lt;span.*?&gt;(.*?)&lt;/span&gt;'</span>, re.S)</div><div class="line">        result = re.search(pattern, page)</div><div class="line">        <span class="keyword">if</span> result:</div><div class="line">            <span class="comment"># print result.group(1)  #测试输出</span></div><div class="line">            <span class="keyword">return</span> result.group(<span class="number">1</span>).strip()</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="comment"># 获取每一层楼的内容,传入页面内容</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getContent</span><span class="params">(self, page)</span>:</span></div><div class="line">        pattern = re.compile(<span class="string">'&lt;div id="post_content_.*?&gt;(.*?)&lt;/div&gt;'</span>, re.S)</div><div class="line">        items = re.findall(pattern, page)</div><div class="line">        <span class="comment"># for item in items:</span></div><div class="line">        <span class="comment">#  print item</span></div><div class="line">        <span class="keyword">print</span> self.tool.replace(items[<span class="number">1</span>])</div><div class="line"></div><div class="line"></div><div class="line">baseURL = <span class="string">'http://tieba.baidu.com/p/3138733512'</span></div><div class="line">bdtb = BDTB(baseURL, <span class="number">1</span>)</div><div class="line">bdtb.getContent(bdtb.getPage(<span class="number">1</span>))</div></pre></td></tr></table></figure>
<p> 运行截图如下：</p>
<p><img src="http://img.blog.csdn.net/20160928085951506" alt="这里写图片描述"></p>
<h4 id="4）替换楼层"><a href="#4）替换楼层" class="headerlink" title="4）替换楼层"></a>4）替换楼层</h4><p>至于这个问题，我感觉直接提取楼层没什么必要呀，因为只看楼主的话，有些楼层的编号是间隔的，所以我们得到的楼层序号是不连续的，这样我们保存下来也没什么用。</p>
<p>所以可以尝试下面的方法：</p>
<blockquote>
<p>1.每打印输出一段楼层，写入一行横线来间隔，或者换行符也好。</p>
<p>2.试着重新编一个楼层，按照顺序，设置一个变量，每打印出一个结果变量加一，打印出这个变量当做楼层。</p>
</blockquote>
<p>将<code>getContent</code>方法修改如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#获取每一层楼的内容,传入页面内容</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getContent</span><span class="params">(self,page)</span>:</span></div><div class="line">    pattern = re.compile(<span class="string">'&lt;div id="post_content_.*?&gt;(.*?)&lt;/div&gt;'</span>,re.S)</div><div class="line">    items = re.findall(pattern,page)</div><div class="line">    floor = <span class="number">1</span></div><div class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> items:</div><div class="line">        <span class="keyword">print</span> floor,<span class="string">u"楼------------------------------------------------------------------------------------------------------------------------------------\n"</span></div><div class="line">        <span class="keyword">print</span> self.tool.replace(item)</div><div class="line">        floor += <span class="number">1</span></div></pre></td></tr></table></figure>
<p>运行结果截图如下：</p>
<p><img src="http://img.blog.csdn.net/20160928102112727" alt="这里写图片描述"></p>
<h3 id="4-写入文件"><a href="#4-写入文件" class="headerlink" title="4. 写入文件"></a><strong>4. 写入文件</strong></h3><p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">file = open(“tb.txt”,”w”)</div><div class="line">file.writelines(obj)</div></pre></td></tr></table></figure>
<h3 id="5-完善代码"><a href="#5-完善代码" class="headerlink" title="5. 完善代码"></a><strong>5. 完善代码</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#-*-coding:utf8-*-</span></div><div class="line"><span class="comment">#created by 10412</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> urllib</div><div class="line"><span class="keyword">import</span> urllib2</div><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line"><span class="comment">#处理页面标签类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tool</span>:</span></div><div class="line">    <span class="comment">#去除img标签,7位长空格</span></div><div class="line">    removeImg = re.compile(<span class="string">'&lt;img.*?&gt;| &#123;7&#125;|'</span>)</div><div class="line">    <span class="comment">#删除超链接标签</span></div><div class="line">    removeAddr = re.compile(<span class="string">'&lt;a.*?&gt;|&lt;/a&gt;'</span>)</div><div class="line">    <span class="comment">#把换行的标签换为\n</span></div><div class="line">    replaceLine = re.compile(<span class="string">'&lt;tr&gt;|&lt;div&gt;|&lt;/div&gt;|&lt;/p&gt;'</span>)</div><div class="line">    <span class="comment">#将表格制表&lt;td&gt;替换为\t</span></div><div class="line">    replaceTD= re.compile(<span class="string">'&lt;td&gt;'</span>)</div><div class="line">    <span class="comment">#把段落开头换为\n加空两格</span></div><div class="line">    replacePara = re.compile(<span class="string">'&lt;p.*?&gt;'</span>)</div><div class="line">    <span class="comment">#将换行符或双换行符替换为\n</span></div><div class="line">    replaceBR = re.compile(<span class="string">'&lt;br&gt;&lt;br&gt;|&lt;br&gt;'</span>)</div><div class="line">    <span class="comment">#将其余标签剔除</span></div><div class="line">    removeExtraTag = re.compile(<span class="string">'&lt;.*?&gt;'</span>)</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">replace</span><span class="params">(self,x)</span>:</span></div><div class="line">        x = re.sub(self.removeImg,<span class="string">""</span>,x)</div><div class="line">        x = re.sub(self.removeAddr,<span class="string">""</span>,x)</div><div class="line">        x = re.sub(self.replaceLine,<span class="string">"\n"</span>,x)</div><div class="line">        x = re.sub(self.replaceTD,<span class="string">"\t"</span>,x)</div><div class="line">        x = re.sub(self.replacePara,<span class="string">"\n    "</span>,x)</div><div class="line">        x = re.sub(self.replaceBR,<span class="string">"\n"</span>,x)</div><div class="line">        x = re.sub(self.removeExtraTag,<span class="string">""</span>,x)</div><div class="line">        <span class="comment">#strip()将前后多余内容删除</span></div><div class="line">        <span class="keyword">return</span> x.strip()</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#百度贴吧爬虫类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BDTB</span>:</span></div><div class="line"></div><div class="line">    <span class="comment">#初始化，传入基地址，是否只看楼主的参数</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,baseUrl,seeLZ,floorTag)</span>:</span></div><div class="line">        <span class="comment">#base链接地址</span></div><div class="line">        self.baseURL = baseUrl</div><div class="line">        <span class="comment">#是否只看楼主</span></div><div class="line">        self.seeLZ = <span class="string">'?see_lz='</span>+str(seeLZ)</div><div class="line">        <span class="comment">#HTML标签剔除工具类对象</span></div><div class="line">        self.tool = Tool()</div><div class="line">        <span class="comment">#全局file变量，文件写入操作对象</span></div><div class="line">        self.file = <span class="keyword">None</span></div><div class="line">        <span class="comment">#楼层标号，初始为1</span></div><div class="line">        self.floor = <span class="number">1</span></div><div class="line">        <span class="comment">#默认的标题，如果没有成功获取到标题的话则会用这个标题</span></div><div class="line">        self.defaultTitle = <span class="string">u"百度贴吧"</span></div><div class="line">        <span class="comment">#是否写入楼分隔符的标记</span></div><div class="line">        self.floorTag = floorTag</div><div class="line"></div><div class="line">    <span class="comment">#传入页码，获取该页帖子的代码</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getPage</span><span class="params">(self,pageNum)</span>:</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            <span class="comment">#构建URL</span></div><div class="line">            url = self.baseURL+ self.seeLZ + <span class="string">'&amp;pn='</span> + str(pageNum)</div><div class="line">            request = urllib2.Request(url)</div><div class="line">            response = urllib2.urlopen(request)</div><div class="line">            <span class="comment">#返回UTF-8格式编码内容</span></div><div class="line">            <span class="keyword">return</span> response.read().decode(<span class="string">'utf-8'</span>)</div><div class="line">        <span class="comment">#无法连接，报错</span></div><div class="line">        <span class="keyword">except</span> urllib2.URLError, e:</div><div class="line">            <span class="keyword">if</span> hasattr(e,<span class="string">"reason"</span>):</div><div class="line">                <span class="keyword">print</span> <span class="string">u"连接百度贴吧失败,错误原因"</span>,e.reason</div><div class="line">                <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="comment">#获取帖子标题</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getTitle</span><span class="params">(self,page)</span>:</span></div><div class="line">        <span class="comment">#得到标题的正则表达式</span></div><div class="line">        pattern = re.compile(<span class="string">'&lt;h1 class="core_title_txt.*?&gt;(.*?)&lt;/h1&gt;'</span>,re.S)</div><div class="line">        result = re.search(pattern,page)</div><div class="line">        <span class="keyword">if</span> result:</div><div class="line">            <span class="comment">#如果存在，则返回标题</span></div><div class="line">            <span class="keyword">return</span> result.group(<span class="number">1</span>).strip()</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="comment">#获取帖子一共有多少页</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getPageNum</span><span class="params">(self,page)</span>:</span></div><div class="line">        <span class="comment">#获取帖子页数的正则表达式</span></div><div class="line">        pattern = re.compile(<span class="string">'&lt;li class="l_reply_num.*?&lt;/span&gt;.*?&lt;span.*?&gt;(.*?)&lt;/span&gt;'</span>,re.S)</div><div class="line">        result = re.search(pattern,page)</div><div class="line">        <span class="keyword">if</span> result:</div><div class="line">            <span class="keyword">return</span> result.group(<span class="number">1</span>).strip()</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="comment">#获取每一层楼的内容,传入页面内容</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getContent</span><span class="params">(self,page)</span>:</span></div><div class="line">        <span class="comment">#匹配所有楼层的内容</span></div><div class="line">        pattern = re.compile(<span class="string">'&lt;div id="post_content_.*?&gt;(.*?)&lt;/div&gt;'</span>,re.S)</div><div class="line">        items = re.findall(pattern,page)</div><div class="line">        contents = []</div><div class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> items:</div><div class="line">            <span class="comment">#将文本进行去除标签处理，同时在前后加入换行符</span></div><div class="line">            content = <span class="string">"\n"</span>+self.tool.replace(item)+<span class="string">"\n"</span></div><div class="line">            contents.append(content.encode(<span class="string">'utf-8'</span>))</div><div class="line">        <span class="keyword">return</span> contents</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setFileTitle</span><span class="params">(self,title)</span>:</span></div><div class="line">        <span class="comment">#如果标题不是为None，即成功获取到标题</span></div><div class="line">        <span class="keyword">if</span> title <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">            self.file = open(title + <span class="string">".txt"</span>,<span class="string">"w+"</span>)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            self.file = open(self.defaultTitle + <span class="string">".txt"</span>,<span class="string">"w+"</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">writeData</span><span class="params">(self,contents)</span>:</span></div><div class="line">        <span class="comment">#向文件写入每一楼的信息</span></div><div class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> contents:</div><div class="line">            <span class="keyword">if</span> self.floorTag == <span class="string">'1'</span>:</div><div class="line">                <span class="comment">#楼之间的分隔符</span></div><div class="line">                floorLine = <span class="string">"\n"</span> + str(self.floor) + <span class="string">u"-----------------------------------------------------------------------------------------\n"</span></div><div class="line">                self.file.write(floorLine)</div><div class="line">            self.file.write(item)</div><div class="line">            self.floor += <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start</span><span class="params">(self)</span>:</span></div><div class="line">        indexPage = self.getPage(<span class="number">1</span>)</div><div class="line">        pageNum = self.getPageNum(indexPage)</div><div class="line">        title = self.getTitle(indexPage)</div><div class="line">        self.setFileTitle(title)</div><div class="line">        <span class="keyword">if</span> pageNum == <span class="keyword">None</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">"URL已失效，请重试"</span></div><div class="line">            <span class="keyword">return</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">"该帖子共有"</span> + str(pageNum) + <span class="string">"页"</span></div><div class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,int(pageNum)+<span class="number">1</span>):</div><div class="line">                <span class="keyword">print</span> <span class="string">"正在写入第"</span> + str(i) + <span class="string">"页数据"</span></div><div class="line">                page = self.getPage(i)</div><div class="line">                contents = self.getContent(page)</div><div class="line">                self.writeData(contents)</div><div class="line">        <span class="comment">#出现写入异常</span></div><div class="line">        <span class="keyword">except</span> IOError,e:</div><div class="line">            <span class="keyword">print</span> <span class="string">"写入异常，原因"</span> + e.message</div><div class="line">        <span class="keyword">finally</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">"写入任务完成"</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">u"请输入帖子代号"</span></div><div class="line">baseURL = <span class="string">'http://tieba.baidu.com/p/'</span> + str(raw_input(<span class="string">u'http://tieba.baidu.com/p/'</span>))</div><div class="line">seeLZ = raw_input(<span class="string">"是否只获取楼主发言，是输入1，否输入0\n"</span>)</div><div class="line">floorTag = raw_input(<span class="string">"是否写入楼层信息，是输入1，否输入0\n"</span>)</div><div class="line">bdtb = BDTB(baseURL,seeLZ,floorTag)</div><div class="line">bdtb.start()</div></pre></td></tr></table></figure>
<p>运行后截图如下：</p>
<p><img src="http://img.blog.csdn.net/20160928102323448" alt="这里写图片描述"></p>
<p><br></p>
<h3 id="备注："><a href="#备注：" class="headerlink" title="备注："></a>备注：</h3><blockquote>
<p>运行后注意输入帖子的代号先在网址后空格，再输入帖子代号，输入完再把刚才的空格</p>
<p>删除，只有这样才不会报错。</p>
<p>Traceback (most recent call last):<br>File “E:/python/code/PycharmProject/Python-Projects/baidutieba/BDTB3.py”, line 149,<br>in &lt; module &gt;<br> bdtb.start()<br>File “E:/python/code/PycharmProject/Python-Projects/baidutieba/BDTB3.py”, line 123, in start<br>pageNum = self.getPageNum(indexPage)<br>File “E:/python/code/PycharmProject/Python-Projects/baidutieba/BDTB3.py”, line 86, in getPageNum<br>result = re.search(pattern,page)<br>File “C:\Python27\lib\re.py”, line 146, in search<br>return _compile(pattern, flags).search(string)<br>TypeError: expected string or buffer</p>
</blockquote>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">Python</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">爬虫</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/28/Python爬虫实战之爬取百度贴吧帖子/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-中缀表达式转换成前缀和后缀表达式这类题目的超实用解题技巧" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/28/中缀表达式转换成前缀和后缀表达式这类题目的超实用解题技巧/">中缀表达式转换成前缀和后缀表达式这类题目的超实用解题技巧</a>
    </h1>
  

        
        <a href="/2017/03/28/中缀表达式转换成前缀和后缀表达式这类题目的超实用解题技巧/" class="archive-article-date">
  	<time datetime="2017-03-28T10:58:16.670Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-28</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>看到了标题如果还不了解的这几个概念的请先看看博客：<a href="http://blog.csdn.net/tzs_1041218129/article/details/52650917"><strong>详解前缀、中缀、后缀表达式</strong></a></p>
<p><br></p>
<hr>
<p>先给几个中缀表达式转换成后缀表达式题目做做吧，最后我们在总结超实用的技巧！！</p>
<hr>
<p><strong>1. 表达式“X=A+B*（C–D）/E”的后缀表示形式可以为</strong></p>
<p>A. XAB+CDE/-*=</p>
<p>B. XA+BC-DE/*=</p>
<p>C. XABCD-*E/+=</p>
<p>D. XABCDE+*/=<br>
        
          <a class="article-more-a" href="/2017/03/28/中缀表达式转换成前缀和后缀表达式这类题目的超实用解题技巧/#more">more >></a>
        
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">数据结构</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">表达式</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/28/中缀表达式转换成前缀和后缀表达式这类题目的超实用解题技巧/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-深度探究Java 中 finally 语句块" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>乍看这个题目，是不是有人会问，这个谁不知道啊，大凡熟悉 Java 编程的人都知道 finally 语句块的作用和用法。有什么可深度辨析的呢？事实并非如此，我发现即使写了很多年 Java 程序的人，也不一定能够透彻的理解 finally 语句块。本篇将以生动形象的案例来带您由浅入深的来分析一下这个小小的 finally，希望这篇文章能够让您真正的理解 finally 语句块的本质，至少阅读完本篇文章后，没有觉得浪费了时间。</p>
<p>可不能小看这个简单的 finally，看似简单的问题背后，却隐藏了无数的玄机。接下来我就带您一步一步的揭开这个 finally 的神秘面纱。</p>
<p>##问题分析<br>首先来问大家一个问题：finally 语句块一定会执行吗？<br>很多人都认为 finally 语句块是肯定要执行的，其中也包括一些很有经验的 Java 程序员。可惜并不像大多人所认为的那样，对于这个问题，答案当然是否定的，我们先来看下面这个例子。</p>
<p>####清单 1.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">public class Test &#123; </div><div class="line">public static void main(String[] args) &#123; </div><div class="line">System.out.println(&quot;return value of test(): &quot; + test()); </div><div class="line"> &#125; </div><div class="line"></div><div class="line">public static int test() &#123; </div><div class="line">int i = 1; </div><div class="line">	</div><div class="line">// 		 if(i == 1) </div><div class="line">// 			 return 0; </div><div class="line">System.out.println(&quot;the previous statement of try block&quot;); </div><div class="line">i = i / 0; </div><div class="line">	</div><div class="line">try &#123; </div><div class="line">   System.out.println(&quot;try block&quot;); </div><div class="line">     return i; </div><div class="line">    &#125;finally &#123; </div><div class="line">    System.out.println(&quot;finally block&quot;); </div><div class="line">	 &#125; </div><div class="line"> &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>清单 1 的执行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">the previous statement of try block </div><div class="line"> Exception in thread &quot;main&quot; java.lang.ArithmeticException: / by zero </div><div class="line"> at com.bj.charlie.Test.test(Test.java:15) </div><div class="line"> at com.bj.charlie.Test.main(Test.java:6)</div></pre></td></tr></table></figure>
<p>另外，如果去掉上例中被注释的两条语句前的注释符，执行结果则是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return value of test(): 0</div></pre></td></tr></table></figure>
<p>在以上两种情况下，finally 语句块都没有执行，说明什么问题呢？只有与 finally 相对应的 try 语句块得到执行的情况下，finally 语句块才会执行。以上两种情况，都是在 try 语句块之前返回（return）或者抛出异常，所以 try 对应的 finally 语句块没有执行。</p>
<p>那好，即使与 finally 相对应的 try 语句块得到执行的情况下，finally 语句块一定会执行吗？不好意思，这次可能又让大家失望了，答案仍然是否定的。请看下面这个例子（清单 2）。</p>
<p>####清单 2.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">public class Test &#123; </div><div class="line">public static void main(String[] args) &#123; </div><div class="line">System.out.println(&quot;return value of test(): &quot; + test()); </div><div class="line"> &#125; </div><div class="line"></div><div class="line">public static int test() &#123; </div><div class="line">int i = 1; </div><div class="line"></div><div class="line">try &#123; </div><div class="line">System.out.println(&quot;try block&quot;); </div><div class="line">System.exit(0); </div><div class="line">return i; </div><div class="line">&#125;finally &#123; </div><div class="line">System.out.println(&quot;finally block&quot;); </div><div class="line">	 &#125; </div><div class="line"> &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>清单 2 的执行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">try block</div></pre></td></tr></table></figure>
<p>finally 语句块还是没有执行，为什么呢？因为我们在 try 语句块中执行了 System.exit (0) 语句，终止了 Java 虚拟机的运行。那有人说了，在一般的 Java 应用中基本上是不会调用这个 System.exit(0) 方法的。OK ！没有问题，我们不调用 System.exit(0) 这个方法，那么 finally 语句块就一定会执行吗？</p>
<p>再一次让大家失望了，答案还是否定的。当一个线程在执行 try 语句块或者 catch 语句块时被打断（interrupted）或者被终止（killed），与其相对应的 finally 语句块可能不会执行。还有更极端的情况，就是在线程运行 try 语句块或者 catch 语句块时，突然死机或者断电，finally 语句块肯定不会执行了。可能有人认为死机、断电这些理由有些强词夺理，没有关系，我们只是为了说明这个问题。</p>
<p>##finally 语句剖析</p>
<p>说了这么多，还是让我们拿出些有说服力的证据吧！还有什么证据比官方的文档更具说服力呢？让我们来看看官方网站上的《The Java Tutorials》中是怎样来描述 finally 语句块的吧！<br>以下位于 <em>**</em> 之间的内容原封不动的摘自于《 The Java Tutorials 》文档。</p>
<hr>
<p>The finally Block<br>The finally block always executes when the try block exits. This ensures that the finally block is executed even if an unexpected exception occurs. But finally is useful for more than just exception handling — it allows the programmer to avoid having cleanup code accidentally bypassed by a return,continue, or break. Putting cleanup code in a finally block is always a good practice, even when no exceptions are anticipated.<br>Note: If the JVM exits while the try or catch code is being executed, then the finally block may not execute. Likewise, if the thread executing the try or catch code is interrupted or killed, the finally block may not execute even though the application as a whole continues.</p>
<hr>
<p>请仔细阅读并认真体会一下以上两段英文，当你真正的理解了这两段英文的确切含义，你就可以非常自信的来回答“finally 语句块是否一定会执行？”这样的问题。看来，大多时候，并不是 Java 语言本身有多么高深，而是我们忽略了对基础知识的深入理解。</p>
<p>接下来，我们看一下 finally 语句块是怎样执行的。在排除了以上 finally 语句块不执行的情况后，finally 语句块就得保证要执行，既然 finally 语句块一定要执行，那么它和 try 语句块与 catch 语句块的执行顺序又是怎样的呢？还有，如果 try 语句块中有 return 语句，那么 finally 语句块是在 return 之前执行，还是在 return 之后执行呢？带着这样一些问题，我们还是以具体的案例来讲解。</p>
<p>关于 try、catch、finally 的执行顺序问题，我们还是来看看权威的论述吧！以下 <em>**</em> 之间的内容摘自 Java 语言规范第四版（《The Java™ Programming Language, Fourth Edition》）中对于 try，catch，和 finally 的描述。</p>
<hr>
<p>12.4. Try, catch, and finally<br>You catch exceptions by enclosing code in Try blocks. The basic syntax for a Try block is:<br>try {<br>statements<br>} catch (exception_type1 identifier1) {<br>statements<br>} catch (exception_type2 identifier2) {<br>statements<br>…<br>} finally {<br>statements<br>}</p>
<p>where either at least one catch clause, or the finally clause, must be present. The body of the try statement is executed until either an exception is thrown or the body finishes successfully. If an exception is thrown, each catch clause is examined in turn, from first to last, to see whether the type of the exception object is assignable to the type declared in the catch. When an assignable catch clause is found, its block is executed with its identifier set to reference the exception object. No other catch clause will be executed. Any number of catch clauses, including zero, can be associated with a particular TRy as long as each clause catches a different type of exception. If no appropriate catch is found, the exception percolates out of the try statement into any outer try that might have a catch clause to handle it.</p>
<p>If a finally clause is present with a try, its code is executed after all other processing in the try is complete. This happens no matter how completion was achieved, whether normally, through an exception, or through a control flow statement such as return or break.</p>
<hr>
<p>上面这段文字的大体意思是说，不管 try 语句块正常结束还是异常结束，finally 语句块是保证要执行的。如果 try 语句块正常结束，那么在 try 语句块中的语句都执行完之后，再执行 finally 语句块。如果 try 中有控制转移语句（return、break、continue）呢？那 finally 语句块是在控制转移语句之前执行，还是之后执行呢？似乎从上面的描述中我们还看不出任何端倪，不要着急，后面的讲解中我们会分析这个问题。如果 try 语句块异常结束，应该先去相应的 catch 块做异常处理，然后执行 finally 语句块。同样的问题，如果 catch 语句块中包含控制转移语句呢？ finally 语句块是在这些控制转移语句之前，还是之后执行呢？我们也会在后续讨论中提到。</p>
<p>其实，关于 try，catch，finally 的执行流程远非这么简单，有兴趣的读者可以参考 Java 语言规范第三版（《The Java™ Language Specification, Third Edition》）中对于 Execution of try-catch-finally 的描述，非常复杂的一个流程。限于篇幅的原因，本文不做摘录，请感兴趣的读者自行阅读。</p>
<p>##finally 语句示例说明</p>
<p>下面，我们先来看一个简单的例子（清单 3）。</p>
<p>####清单 3.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public class Test &#123; </div><div class="line">public static void main(String[] args) &#123;  </div><div class="line">try &#123;  </div><div class="line">System.out.println(&quot;try block&quot;);  </div><div class="line"></div><div class="line">return ;  </div><div class="line">&#125; finally &#123;  </div><div class="line">System.out.println(&quot;finally block&quot;);  </div><div class="line">	 &#125;  </div><div class="line"> &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>清单 3 的执行结果为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">try block </div><div class="line">finally block</div></pre></td></tr></table></figure></p>
<p>清单 3 说明 finally 语句块在 try 语句块中的 return 语句之前执行。我们再来看另一个例子（清单 4）。</p>
<p>####清单 4.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">public class Test &#123; </div><div class="line">public static void main(String[] args) &#123;  </div><div class="line">System.out.println(&quot;reture value of test() : &quot; + test()); </div><div class="line"> &#125; </div><div class="line"></div><div class="line">public static int test()&#123; </div><div class="line">int i = 1; </div><div class="line">	</div><div class="line">try &#123;  </div><div class="line">System.out.println(&quot;try block&quot;);  </div><div class="line">		 i = 1 / 0; </div><div class="line">return 1;  </div><div class="line">&#125;catch (Exception e)&#123; </div><div class="line">System.out.println(&quot;exception block&quot;); </div><div class="line">return 2; </div><div class="line">&#125;finally &#123;  </div><div class="line">System.out.println(&quot;finally block&quot;);  </div><div class="line">	 &#125; </div><div class="line"> &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>清单 4 的执行结果为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">try block </div><div class="line">exception block </div><div class="line">finally block </div><div class="line">reture value of test() : 2</div></pre></td></tr></table></figure></p>
<p>清单 4 说明了 finally 语句块在 catch 语句块中的 return 语句之前执行。</p>
<p>从上面的清单 3 和清单 4，我们可以看出，其实 finally 语句块是在 try 或者 catch 中的 return 语句之前执行的。更加一般的说法是，finally 语句块应该是在控制转移语句之前执行，控制转移语句除了 return 外，还有 break 和 continue。另外，throw 语句也属于控制转移语句。虽然 return、throw、break 和 continue 都是控制转移语句，但是它们之间是有区别的。其中 return 和 throw 把程序控制权转交给它们的调用者（invoker），而 break 和 continue 的控制权是在当前方法内转移。请大家先记住它们的区别，在后续的分析中我们还会谈到。</p>
<p>还是得来点有说服力的证据，下面这段摘自 Java 语言规范第四版（《The Java™ Programming Language, Fourth Edition》），请读者自己体会一下其含义。</p>
<hr>
<p>Afinallyclause can also be used to clean up forbreak,continue, andreturn, which is one reason you will sometimes see atryclause with nocatchclauses. When any control transfer statement is executed, all relevantfinallyclauses are executed. There is no way to leave atryblock without executing itsfinallyclause.</p>
<hr>
<p>好了，看到这里，是不是有人认为自己已经掌握了 finally 的用法了？先别忙着下结论，我们再来看两个例子 – 清单 5 和清单 6。</p>
<p>####清单 5.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">public class Test &#123; </div><div class="line"> public static void main(String[] args) &#123; </div><div class="line">        System.out.println(&quot;return value of getValue(): &quot; + getValue()); </div><div class="line">	 &#125; </div><div class="line"></div><div class="line"> public static int getValue() &#123; </div><div class="line">        try &#123; </div><div class="line">                 return 0; </div><div class="line">        &#125; finally &#123; </div><div class="line">                 return 1; </div><div class="line">	        &#125; </div><div class="line">	 &#125; </div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>清单 5 的执行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return value of getValue(): 1</div></pre></td></tr></table></figure></p>
<p>####清单 6.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">public class Test &#123; </div><div class="line">public static void main(String[] args) &#123; </div><div class="line">       System.out.println(&quot;return value of getValue(): &quot; + getValue()); </div><div class="line"> &#125; </div><div class="line"></div><div class="line">public static int getValue() &#123; </div><div class="line">       int i = 1; </div><div class="line">       try &#123; </div><div class="line">                return i; </div><div class="line">       &#125; finally &#123; </div><div class="line">                i++; </div><div class="line">       &#125; </div><div class="line"> &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>清单 6 的执行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return value of getValue(): 1</div></pre></td></tr></table></figure></p>
<p>利用我们上面分析得出的结论：finally 语句块是在 try 或者 catch 中的 return 语句之前执行的。 由此，可以轻松的理解清单 5 的执行结果是 1。因为 finally 中的 return 1；语句要在 try 中的 return 0；语句之前执行，那么 finally 中的 return 1；语句执行后，把程序的控制权转交给了它的调用者 main（）函数，并且返回值为 1。那为什么清单 6 的返回值不是 2，而是 1 呢？按照清单 5 的分析逻辑，finally 中的 i++；语句应该在 try 中的 return i；之前执行啊？ i 的初始值为 1，那么执行 i++；之后为 2，再执行 return i；那不就应该是 2 吗？怎么变成 1 了呢？</p>
<p>关于 Java 虚拟机是如何编译 finally 语句块的问题，有兴趣的读者可以参考《 The JavaTM Virtual Machine Specification, Second Edition 》中 7.13 节 Compiling finally。那里详细介绍了 Java 虚拟机是如何编译 finally 语句块。实际上，Java 虚拟机会把 finally 语句块作为 subroutine（对于这个 subroutine 不知该如何翻译为好，干脆就不翻译了，免得产生歧义和误解。）直接插入到 try 语句块或者 catch 语句块的控制转移语句之前。但是，还有另外一个不可忽视的因素，那就是在执行 subroutine（也就是 finally 语句块）之前，try 或者 catch 语句块会保留其返回值到本地变量表（Local Variable Table）中。待 subroutine 执行完毕之后，再恢复保留的返回值到操作数栈中，然后通过 return 或者 throw 语句将其返回给该方法的调用者（invoker）。请注意，前文中我们曾经提到过 return、throw 和 break、continue 的区别，对于这条规则（保留返回值），只适用于 return 和 throw 语句，不适用于 break 和 continue 语句，因为它们根本就没有返回值。</p>
<p>是不是不太好理解，那我们就用具体的例子来做形象的说明吧！</p>
<p>为了能够解释清单 6 的执行结果，我们来分析一下清单 6 的字节码（byte-code）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">Compiled from &quot;Test.java&quot;</div><div class="line"> public class Test extends java.lang.Object&#123; </div><div class="line"> public Test(); </div><div class="line">  Code: </div><div class="line">   0: 	 aload_0 </div><div class="line">   1:invokespecial#1; //Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V </div><div class="line">   4: 	 return </div><div class="line"></div><div class="line">  LineNumberTable: </div><div class="line">   line 1: 0 </div><div class="line"></div><div class="line"> public static void main(java.lang.String[]); </div><div class="line">  Code: </div><div class="line">   0: 	 getstatic 	 #2; //Field java/lang/System.out:Ljava/io/PrintStream; </div><div class="line">   3: 	 new 	 #3; //class java/lang/StringBuilder </div><div class="line">   6: 	 dup </div><div class="line">   7: 	 invokespecial 	 #4; //Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V </div><div class="line">   10: 	 ldc 	 #5; //String return value of getValue(): </div><div class="line">   12: 	 invokevirtual 	 </div><div class="line">   #6; //Method java/lang/StringBuilder.append:(</div><div class="line">       Ljava/lang/String;)Ljava/lang/StringBuilder; </div><div class="line">   15: 	 invokestatic 	 #7; //Method getValue:()I </div><div class="line">   18: 	 invokevirtual 	 </div><div class="line">   #8; //Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder; </div><div class="line">   21: 	 invokevirtual 	 </div><div class="line">   #9; //Method java/lang/StringBuilder.toString:()Ljava/lang/String; </div><div class="line">   24: 	 invokevirtual 	 #10; //Method java/io/PrintStream.println:(Ljava/lang/String;)V </div><div class="line">   27: 	 return </div><div class="line"></div><div class="line"> public static int getValue(); </div><div class="line">  Code: </div><div class="line">   0: 	 iconst_1 </div><div class="line">   1: 	 istore_0 </div><div class="line">   2: 	 iload_0 </div><div class="line">   3: 	 istore_1 </div><div class="line">   4: 	 iinc 	 0, 1 </div><div class="line">   7: 	 iload_1 </div><div class="line">   8: 	 ireturn </div><div class="line">   9: 	 astore_2 </div><div class="line">   10: 	 iinc 	 0, 1 </div><div class="line">   13: 	 aload_2 </div><div class="line">   14: 	 athrow </div><div class="line">  Exception table: </div><div class="line">   from   to  target type </div><div class="line">     2     4     9   any </div><div class="line">     9    10     9   any </div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>对于 Test（）构造方法与 main（）方法，在这里，我们不做过多解释。让我们来分析一下 getValue（）方法的执行。在这之前，先让我把 getValue（）中用到的虚拟机指令解释一下，以便读者能够正确的理解该函数的执行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">1.	iconst_ </div><div class="line">Description: Push the int constant  (-1, 0, 1, 2, 3, 4 or 5) onto the operand stack.</div><div class="line">Forms: iconst_m1 = 2 (0x2)  iconst_0 = 3 (0x3)  iconst_1 = 4 (0x4)  </div><div class="line">iconst_2 = 5 (0x5) iconst_3 = 6 (0x6)  iconst_4 = 7 (0x7)  iconst_5 = 8 (0x8)</div><div class="line"></div><div class="line">2.	istore_ </div><div class="line">Description: Store int into local variable. The  must be an index into the </div><div class="line">local variable array of the current frame. </div><div class="line">Forms: istore_0 = 59 (0x3b)  istore_1 = 60 (0x3c)  istore_2 = 61 (0x3d)  </div><div class="line">istore_3 = 62 (0x3e)</div><div class="line"></div><div class="line">3.	iload_ </div><div class="line">Description: Load int from local variable. The  must be an index into the </div><div class="line">local variable array of the current frame. </div><div class="line">Forms: iload_0 = 26 (0x1a)  iload_1 = 27 (0x1b)  iload_2 = 28 (0x1c)  iload_3 = 29 (0x1d)</div><div class="line"></div><div class="line">4.	iinc index, const </div><div class="line">Description: Increment local variable by constant. The index is an unsigned byte that </div><div class="line">must be an index into the local variable array of the current frame. The const is an </div><div class="line">immediate signed byte. The local variable at index must contain an int. The value </div><div class="line">const is first sign-extended to an int, and then the local variable at index is </div><div class="line">incremented by that amount.</div><div class="line">Forms:  iinc = 132 (0x84)</div><div class="line"></div><div class="line">Format:</div><div class="line">iinc 	</div><div class="line">index 	</div><div class="line">const 	</div><div class="line"></div><div class="line">5.	ireturn </div><div class="line">Description: Return int from method.</div><div class="line">Forms:  ireturn = 172 (0xac)</div><div class="line"></div><div class="line">6.	astore_ </div><div class="line">Description: Store reference into local variable. The  must be an index into the </div><div class="line">local variable array of the current frame.</div><div class="line">Forms: astore_0 = 75 (0x4b) astore_1 = 76 (0x4c) astore_2 =77 (0x4d) astore_3 =78 (0x4e)</div><div class="line"></div><div class="line">7.	aload_ </div><div class="line">Description: Load reference from local variable. The  must be an index into the </div><div class="line">local variable array of the current frame.</div><div class="line">Forms: aload_0 = 42 (0x2a) aload_1 = 43 (0x2b) aload_2 = 44 (0x2c) aload_3 = 45 (0x2d)</div><div class="line"></div><div class="line">8.	athrow </div><div class="line">Description: Throw exception or error.</div><div class="line">Forms: athrow = 191 (0xbf)</div></pre></td></tr></table></figure>
<p>有了以上的 Java 虚拟机指令，我们来分析一下其执行顺序：分为正常执行（没有 exception）和异常执行（有 exception）两种情况。我们先来看一下正常执行的情况，如图 1 所示：</p>
<p>###图 1. getValue（）函数正常执行的情况</p>
<p><img src="http://img.blog.csdn.net/20161103124450067" alt="这里写图片描述"></p>
<p>由上图，我们可以清晰的看出，在 finally 语句块（iinc 0, 1）执行之前，getValue（）方法保存了其返回值（1）到本地表量表中 1 的位置，完成这个任务的指令是 istore_1；然后执行 finally 语句块（iinc 0, 1），finally 语句块把位于 0 这个位置的本地变量表中的值加 1，变成 2；待 finally 语句块执行完毕之后，把本地表量表中 1 的位置上值恢复到操作数栈（iload_1），最后执行 ireturn 指令把当前操作数栈中的值（1）返回给其调用者（main）。这就是为什么清单 6 的执行结果是 1，而不是 2 的原因。</p>
<p>再让我们来看看异常执行的情况。是不是有人会问，你的清单 6 中都没有 catch 语句，哪来的异常处理呢？我觉得这是一个好问题，其实，即使没有 catch 语句，Java 编译器编译出的字节码中还是有默认的异常处理的，别忘了，除了需要捕获的异常，还可能有不需捕获的异常（如：RunTimeException 和 Error）。</p>
<p>从 getValue（）方法的字节码中，我们可以看到它的异常处理表（exception table）， 如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Exception table:</div><div class="line">from to target type</div><div class="line">2 4 9 any</div></pre></td></tr></table></figure></p>
<p>它的意思是说：如果从 2 到 4 这段指令出现异常，则由从 9 开始的指令来处理。</p>
<p>###图 2. getValue（）函数异常执行的情况</p>
<p><img src="http://img.blog.csdn.net/20161103124615466" alt="这里写图片描述"></p>
<p>先说明一点，上图中的 exception 其实应该是 exception 对象的引用，为了方便说明，我直接把它写成 exception 了。</p>
<p>由上图（图 2）可知，当从 2 到 4 这段指令出现异常时，将会产生一个 exception 对象，并且把它压入当前操作数栈的栈顶。接下来是 astore_2 这条指令，它负责把 exception 对象保存到本地变量表中 2 的位置，然后执行 finally 语句块，待 finally 语句块执行完毕后，再由 aload_2 这条指令把预先存储的 exception 对象恢复到操作数栈中，最后由 athrow 指令将其返回给该方法的调用者（main）。</p>
<p>通过以上的分析，大家应该已经清楚 try-catch-finally 语句块的执行流程了吧！<br>为了更具说服力，我们还是来引经据典吧！大家可以不相信我，难道还不相信“高司令”（Gosling）吗？下面这段仍然摘自 Java 语言规范第四版 《The Java™ Programming Language, Fourth Edition》，请读者自己体会吧！</p>
<hr>
<p>a finally clause is always entered with a reason. That reason may be that the try code finished normally, that it executed a control flow statement such as return, or that an exception was thrown in code executed in the Try block. The reason is remembered when the finally clause exits by falling out the bottom. However, if the finally block creates its own reason to leave by executing a control flow statement (such as break or return) or by throwing an exception, that reason supersedes the original one, and the original reason is forgotten. For example, consider the following code:<br>try {<br>// … do something …<br>return 1;<br>} finally {<br>return 2;<br>}<br>When the Try block executes its return, the finally block is entered with the “reason” of returning the value 1. However, inside the finally block the value 2 is returned, so the initial intention is forgotten. In fact, if any of the other code in the try block had thrown an exception, the result would still be to return 2. If the finally block did not return a value but simply fell out the bottom, the “return the value 1 ″ reason would be remembered and carried out.</p>
<hr>
<p>好了，有了以上的知识，让我们再来看以下 3 个例子。</p>
<p>####清单 7.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public class Test &#123; </div><div class="line"> public static void main(String[] args) &#123; </div><div class="line">        System.out.println(&quot;return value of getValue(): &quot; + getValue()); </div><div class="line">	 &#125; </div><div class="line"></div><div class="line"> @SuppressWarnings(&quot;finally&quot;) </div><div class="line"> public static int getValue() &#123; </div><div class="line">        int i = 1; </div><div class="line">        try &#123; </div><div class="line">                 i = 4; </div><div class="line">        &#125; finally &#123; </div><div class="line">                 i++; </div><div class="line">                 return i; </div><div class="line">        &#125; </div><div class="line">	 &#125; </div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>清单 7 的执行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return value of getValue(): 5</div></pre></td></tr></table></figure></p>
<p>####清单 8.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public class Test &#123; </div><div class="line">public static void main(String[] args) &#123; </div><div class="line">       System.out.println(&quot;return value of getValue(): &quot; + getValue()); </div><div class="line"> &#125; </div><div class="line"></div><div class="line">public static int getValue() &#123; </div><div class="line">       int i = 1; </div><div class="line">       try &#123; </div><div class="line">                i = 4; </div><div class="line">       &#125; finally &#123; </div><div class="line">                i++; </div><div class="line">       &#125; </div><div class="line">       </div><div class="line">       return i; </div><div class="line"> &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>清单 8 的执行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return value of getValue(): 5</div></pre></td></tr></table></figure></p>
<p>清单 7 和清单 8 应该还比较简单吧！利用我们上面讲解的知识，很容易分析出其结果。让我们再来看一个稍微复杂一点的例子 – 清单 9。我建议大家最好先不要看执行结果，运用学过的知识来分析一下，看是否能推断出正确的结果。</p>
<p>####清单 9.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">public class Test &#123; </div><div class="line">public static void main(String[] args) &#123;  </div><div class="line">System.out.println(test());  </div><div class="line"> &#125;  </div><div class="line"></div><div class="line">public static String test() &#123;  </div><div class="line">try &#123;  </div><div class="line">System.out.println(&quot;try block&quot;);  </div><div class="line">return test1();  </div><div class="line">&#125; finally &#123;  </div><div class="line">System.out.println(&quot;finally block&quot;);  </div><div class="line">	 &#125;  </div><div class="line"> &#125;  </div><div class="line">public static String test1() &#123;  </div><div class="line">System.out.println(&quot;return statement&quot;);  </div><div class="line">return &quot;after return&quot;;  </div><div class="line"> &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>清单 9 的结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">try block </div><div class="line">return statement </div><div class="line">finally block </div><div class="line">after return</div></pre></td></tr></table></figure></p>
<p>你分析对了吗？其实这个案例也不算很难，<code>return test1();</code>这条语句等同于 :<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">String tmp = test1(); </div><div class="line">return tmp;</div></pre></td></tr></table></figure></p>
<p>这样，就应该清楚为什么是上面所示的执行结果了吧！</p>
<p>好了，就写到这吧！希望大家看完这篇文章能够有所收获！</p>
<p>##总结<br>没想到吧！一个小小的、看似简单的 finally 语句块背后居然隐藏了这么多玄机。看来，我们平时还是应该认真的阅读 Java 相关的基础文档，比如：Java 语言规范、Java 虚拟机规范等，很多棘手的问题都可以从中得到答案。只有真正的吃透了基础知识，才能达到运用自如的境界！</p>
<p>###参考资料</p>
<p>参考 <a href="http://download.oracle.com/javase/tutorial/essential/exceptions/finally.html" target="_blank" rel="external">The Java Tutorials</a>，查看对 finally 语句块的描述。</p>
<p>参考 <a href="http://java.sun.com/docs/books/javaprog/" target="_blank" rel="external">《The Java Programming Language, Fourth Edition》</a>，查看 Java 语言规范第四版中对 finally 语句块的解释。</p>
<p>参考 <a href="http://java.sun.com/docs/books/jls/third_edition/html/intro.html" target="_blank" rel="external">《The Java Language Specification, Third Edition》</a>，查看 Java 语言规范第三版中对 finally 语句块执行流程的具体描述。</p>
<p>参考 <a href="http://java.sun.com/docs/books/jvms/second_edition/html/VMSpecTOC.doc.html" target="_blank" rel="external">《The Java Virtual Machine Specification, Second Edition》</a>，查看 Java 虚拟机是如何来编译 finally 语句块的知识。</p>
<p>查看文章 <a href="http://dev.firnow.com/course/3_program/java/javajs/200866/122723.html" target="_blank" rel="external">《Java 的异常处理机制(try … catch … finally)》</a>，了解更多关于 Java 中 finally 语句块的分析。</p>
<p>查看文章 <a href="http://neoremind.net/2010/11/java_finally/" target="_blank" rel="external">《Java 中 finally 的辨析》</a>，了解更多关于 Java 中 finally 语句块的分析。</p>
<p>查看文章<a href="http://neoremind.net/2010/11/java_finally/" target="_blank" rel="external">《关于 Java 中 finally 语句块的深度辨析》</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/28/深度探究Java 中 finally 语句块/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-利用Github Page 搭建个人博客网站" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="利用Github-Page-搭建个人博客网站"><a href="#利用Github-Page-搭建个人博客网站" class="headerlink" title="利用Github Page 搭建个人博客网站"></a>利用Github Page 搭建个人博客网站</h1><p>转载请注明出处：</p>
<p><a href="http://blog.csdn.net/tzs_1041218129/article/details/53214497" target="_blank" rel="external">http://blog.csdn.net/tzs_1041218129/article/details/53214497</a></p>
<p><a href="http://www.54tianzhisheng.cn/Blog/html/blog_github.html" target="_blank" rel="external">http://www.54tianzhisheng.cn/Blog/html/blog_github.html</a>  (阅读效果最好)</p>
<p>更多精彩文章请关注微信公众号：<strong>猿blog</strong></p>
<p><img src="http://img.blog.csdn.net/20161022141613763" alt=""></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近这几天，没事干，想找点事折腾下，于是自己便想到了自己一直想干的一件事：搭建一个属于自己的博客网站。目前搭建个人 <code>blog</code> 网站最好的是用 <code>wordpress</code> ，但是那个折腾起来好像还挺麻烦的，再加上还需要自己修改些前端代码和用 <code>PHP</code> 做（虽然我学了几天拍黄片，但是早已忘了），然后就是用 <code>Github Page</code> 吧，自己也一直在这个最大的交友网站装 X 。想想就用这个吧（后来好像觉得这个还挺省事的）</p>
<p>再说说拥有个人博客网站的好处吧：</p>
<ul>
<li>装 X（如果网站够炫）</li>
<li>很好的用来总结自己所学的知识</li>
<li>面试加分（在简历上放上自己的个人网站链接，面试官就可以更好的了解你，知道你所学知识的深度和广度）</li>
<li>不再受其他博客平台的规则所束缚</li>
</ul>
<p>如果你现在还没有自己个人博客网站的话，那么我觉得你看完本篇博客后，强烈的建议你去折腾折腾下，搞个自己的，让自己也能够体验装 X 的感觉。</p>
<p>要想用搭建一个个人博客网站，首先你得有一个域名，这样别人才可以通过域名访问，其次你还要一个空间来存放你的页面。</p>
<ul>
<li>域名  域名的话，你可以在万网、阿里云、腾讯云等注册，我的域名 <a href="http://www.54tianzhisheng.cn/" target="_blank" rel="external">www.54tianzhisheng.cn</a> 就是在腾讯云注册的，记得是腾讯云一元钱（一个域名+主机）搞的，这是腾讯云对学生才有这优惠。  <code>.cn</code> 的域名需要备案，备案的审核速度我觉得还是挺快的，还需要上传证件。当然你也可以买其他的那些不需要备案的域名，省得麻烦事。</li>
<li>空间  空间有免费的空间，也有收费的空间。免费的当然就不够稳定了，收费的就很贵了，终究是很不爽，有没有什么地方是既免费又稳定的空间呢？有，<code>Github</code> 。它允许上传个人网站项目并自定义你的域名，而且又有稳定的服务，实在是不能够在好了。</li>
</ul>
<p>下面就一起跟着我来一步一步的利用 Github 搭建个人博客网站吧！</p>
<h2 id="1-拥有一个域名"><a href="#1-拥有一个域名" class="headerlink" title="1.  拥有一个域名"></a>1.  拥有一个域名</h2><p>这个步骤我就不详述了。</p>
<p>举例：</p>
<blockquote>
<ul>
<li>打开腾讯云官网</li>
<li>搜索你想要的域名，下单买一个</li>
</ul>
</blockquote>
<h2 id="2-拥有一个-Github账号"><a href="#2-拥有一个-Github账号" class="headerlink" title="2.  拥有一个 Github账号"></a>2.  拥有一个 Github账号</h2><p>互联网崇尚自由与分享。<code>Github</code> 是一个全世界程序员聚集的地方，大家相互分享自己写的代码，提升别人，也提升自己。大家都在为着开源社区努力着。因为我从开源项目中学到很多知识，所以我也非常愿意分享我的所见所学所得，我的 Github 主页：<a href="https://github.com/zhisheng17" target="_blank" rel="external">https://github.com/zhisheng17</a>   （欢迎 follow 和对我的项目给个 star 或者 fork 我的项目一起来和我完善项目）</p>
<p>如果还没有 Github 账号的话你就先去注册一个吧，有的话，直接登录就行，后面的操作都要用到 Github 的。</p>
<h2 id="3-Github-上新建个人网站项目"><a href="#3-Github-上新建个人网站项目" class="headerlink" title="3.  Github 上新建个人网站项目"></a>3.  Github 上新建个人网站项目</h2><p>登录 GitHub 之后，在页面右上角点击 + 加号按钮，点击 New repository。</p>
<p><img src="http://img.blog.csdn.net/20161118112513049" alt="这里写图片描述"></p>
<p>由于我们是新建一个个人网站项目，所有仓库的名称需要安装 GitHub 个人网站项目的规定来写。 </p>
<p>规则就是：</p>
<blockquote>
<p>YOUR-GITHUB-USERNAME.github.io</p>
</blockquote>
<p>比如我的 GitHub 用户名是 zhisheng17，那我就要填写 zhisheng17.github.io。然后选择公开模式，接着点击创建仓库按钮。</p>
<p><img src="http://img.blog.csdn.net/20161118112535628" alt="这里写图片描述"></p>
<p>创建成功之后，进入了项目主页面。点击设置按钮。</p>
<p><img src="http://img.blog.csdn.net/20161118112548862" alt="这里写图片描述"></p>
<p>进入之后，滚动页面到下方。点击页面自动生成器按钮。</p>
<p><img src="http://img.blog.csdn.net/20161118112618676" alt="这里写图片描述"></p>
<p>点击右下方继续去布局按钮。</p>
<p><img src="http://img.blog.csdn.net/20161118112632988" alt="这里写图片描述"></p>
<p>选择一个模板，点击发布页面按钮。</p>
<p><img src="http://img.blog.csdn.net/20161118112649285" alt="这里写图片描述"></p>
<p><img src="http://img.blog.csdn.net/20161118112702863" alt="这里写图片描述"></p>
<p>这个时候，你就可以通过YOUR-GITHUB-USERNAME.github.io来访问此页面了。</p>
<h2 id="4-上传个人网页到-Github"><a href="#4-上传个人网页到-Github" class="headerlink" title="4.  上传个人网页到 Github"></a>4.  上传个人网页到 Github</h2><p>自动生成页面，肯定不符合我们的要求，我们希望能够自己设计自己的个人网站。我们可以自己编写一个网页文件，命名为 index.html。然后上传到 GitHub个人网站项目上。这里为了节约时间，可以先下载我的个人网站项目代码，然后修改为你的网页上传到 GitHub。</p>
<p>下面介绍详细步骤。</p>
<p>进入此项目<a href="https://github.com/zhisheng17/zhisheng17.github.io，然后下载源码。解压之后，拿到里面的index.html文件。" target="_blank" rel="external">https://github.com/zhisheng17/zhisheng17.github.io，然后下载源码。解压之后，拿到里面的index.html文件。</a></p>
<p><img src="http://img.blog.csdn.net/20161118112724270" alt="这里写图片描述"></p>
<p>然后进入自己的个人网站项目主页 YOUR-GITHUB-USERNAME/YOUR-GITHUB-USERNAME.github.io。点击上传文件按钮，进入上传文件页面，将 index.html 文件拖入蓝色大圈圈区域，点击提交按钮即可提交成功。此时打开网址 YOUR-GITHUB-USERNAME.github.io 就可以看到主页已经改变为我们自己的网页了。</p>
<p><img src="http://img.blog.csdn.net/20161118112739254" alt="这里写图片描述"></p>
<p><img src="http://img.blog.csdn.net/20161118112749286" alt="这里写图片描述"></p>
<p>通过 zhisheng17.github.io 查看效果：</p>
<p><img src="http://img.blog.csdn.net/20161118112806005" alt="这里写图片描述"></p>
<h2 id="5-域名CNAME到个人网站项目"><a href="#5-域名CNAME到个人网站项目" class="headerlink" title="5.  域名CNAME到个人网站项目"></a>5.  域名CNAME到个人网站项目</h2><p>网页上传成功了，我们不想一直通过YOUR-GITHUB-USERNAME.github.io来访问我们的个人网站，而是希望通过自己的域名来访问。</p>
<p>下面讲述详细步骤。</p>
<p>点击我们的个人网站项目设置选项卡，滚动到下面，就会发现一个自定义域名卡片。输入我们买的域名，然后点击保存。</p>
<p><img src="http://img.blog.csdn.net/20161118112822412" alt="这里写图片描述"></p>
<p><img src="http://img.blog.csdn.net/20161118112832442" alt="这里写图片描述"></p>
<p>接着我们还要将我们的域名解析到这个个人网站项目上。因为我的域名是在腾讯云上面买的，所以我打开腾讯云域名管理页面，进行相关的设置。</p>
<p><img src="http://img.blog.csdn.net/20161118112844896" alt="这里写图片描述"></p>
<p>接着，点击添加一条域名解析记录，主机填写www，代表你是一级域名来访问，指向填写YOUR-GITHUB-USERNAME.github.io，然后点击保存按钮。应该要等会，域名的解析时间可能不一样，我的腾讯云就是很慢的</p>
<p><img src="http://img.blog.csdn.net/20161118112856522" alt="这里写图片描述"></p>
<h2 id="6-访问你的域名"><a href="#6-访问你的域名" class="headerlink" title="6.  访问你的域名"></a>6.  访问你的域名</h2><p>所有这些步骤做完之后，在浏览器里输入自己的域名，回车键一按，就会返回我们刚刚上传到 GitHub 的index.html 页面了。</p>
<p>这里只是入门了 GitHub 搭建个人网站的功能，GitHub 官方推荐 Jekyll 博客系统来发布自己的页面。以后有数据更新，都可以通过 Jekyll 来重新编译整个网站。（期待后续我的使用 Jekyll 博客系统发布自己博客的文章吧）</p>
<p><img src="http://img.blog.csdn.net/20161118112911098" alt="这里写图片描述"></p>
<h2 id="7-注意事项"><a href="#7-注意事项" class="headerlink" title="7.  注意事项"></a>7.  注意事项</h2><p>尽管GitHub个人网站项目是免费的，但是却有一些限制。总体来说，完全够用，甚至太多了。</p>
<ul>
<li>单个仓库大小不超过1GB，上传单个文件大小不能超过100MB，如果通过浏览器上传不能超过25MB</li>
<li>个人网站项目也不例外，最大空间1GB</li>
<li>个人网站项目每个月访问请求数不能超过10万次，总流量不能超过100GB</li>
<li>个人网站项目一小时创建数量不能超过10个</li>
</ul>
<p>当然了，这些政策可能随时改变，可以通过此网页查看最新政策。 <a href="https://help.github.com/articles/what-is-github-pages/#recommended-limits" target="_blank" rel="external">https://help.github.com/articles/what-is-github-pages/#recommended-limits</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/28/利用Github Page 搭建个人博客网站/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-通过项目逐步深入了解Mybatis-一-" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/28/通过项目逐步深入了解Mybatis-一-/">通过项目逐步深入了解Mybatis（一）</a>
    </h1>
  

        
        <a href="/2017/03/28/通过项目逐步深入了解Mybatis-一-/" class="archive-article-date">
  	<time datetime="2017-03-28T10:56:34.415Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-28</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h1><p>Mybatis 和 SpringMVC 通过订单商品案例驱动</p>
<p>官方中文地址：<a href="http://www.mybatis.org/mybatis-3/zh/">http://www.mybatis.org/mybatis-3/zh/</a></p>
<p>官方托管地址：<a href="https://github.com/mybatis/mybatis-3">https://github.com/mybatis/mybatis-3</a></p>
<p>本项目全部代码地址：<a href="https://github.com/zhisheng17/mybatis">https://github.com/zhisheng17/mybatis</a></p>
<h3 id="如果觉得不错的话，欢迎给个-star-，-如果你想完善这个项目的话，你也可以-fork-后修改然后推送给我。"><a href="#如果觉得不错的话，欢迎给个-star-，-如果你想完善这个项目的话，你也可以-fork-后修改然后推送给我。" class="headerlink" title="如果觉得不错的话，欢迎给个 star ， 如果你想完善这个项目的话，你也可以 fork 后修改然后推送给我。"></a>如果觉得不错的话，欢迎给个 star ， 如果你想完善这个项目的话，你也可以 fork 后修改然后推送给我。</h3><h1 id="基础知识："><a href="#基础知识：" class="headerlink" title="基础知识："></a>基础知识：</h1><h2 id="对原生态-jdbc-程序（单独使用-jdbc-开发）问题总结"><a href="#对原生态-jdbc-程序（单独使用-jdbc-开发）问题总结" class="headerlink" title="对原生态 jdbc 程序（单独使用 jdbc 开发）问题总结"></a>对原生态 jdbc 程序（单独使用 jdbc 开发）问题总结</h2>
        
          <a class="article-more-a" href="/2017/03/28/通过项目逐步深入了解Mybatis-一-/#more">more >></a>
        
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">Mybatis</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">SpringMVC</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/28/通过项目逐步深入了解Mybatis-一-/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-通过项目逐步深入了解Mybatis-二-" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/28/通过项目逐步深入了解Mybatis-二-/">通过项目逐步深入了解Mybatis（二）</a>
    </h1>
  

        
        <a href="/2017/03/28/通过项目逐步深入了解Mybatis-二-/" class="archive-article-date">
  	<time datetime="2017-03-28T10:56:21.447Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-28</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>转载请务必注明出处，原创不易！</p>
<p>####相关文章：<a href="http://blog.csdn.net/tzs_1041218129/article/details/53404326"><strong>通过项目逐步深入了解Mybatis&lt;一&gt;</strong></a></p>
<p>####本项目全部代码地址：<a href="https://github.com/zhisheng17/mybatis"><strong>Github-Mybatis</strong></a></p>
<h3 id="Mybatis-解决-jdbc-编程的问题"><a href="#Mybatis-解决-jdbc-编程的问题" class="headerlink" title="Mybatis 解决 jdbc 编程的问题"></a>Mybatis 解决 jdbc 编程的问题</h3><p>1、  数据库链接创建、释放频繁造成系统资源浪费从而影响系统性能，如果使用数据库链接池可解决此问题。</p>
<p>解决：在SqlMapConfig.xml中配置数据链接池，使用连接池管理数据库链接。</p>
<p>2、  Sql语句写在代码中造成代码不易维护，实际应用sql变化的可能较大，sql变动需要改变java代码。</p>
<p>解决：将Sql语句配置在XXXXmapper.xml文件中与java代码分离。</p>
<p>3、  向sql语句传参数麻烦，因为sql语句的where条件不一定，可能多也可能少，占位符需要和参数一一对应。</p>
<p>解决：Mybatis自动将java对象映射至sql语句，通过statement中的parameterType定义输入参数的类型。</p>
<p>4、  对结果集解析麻烦，sql变化导致解析代码变化，且解析前需要遍历，如果能将数据库记录封装成pojo对象解析比较方便。</p>
<p>解决：Mybatis自动将sql执行结果映射至java对象，通过statement中的resultType定义输出结果的类型。</p>
        
          <a class="article-more-a" href="/2017/03/28/通过项目逐步深入了解Mybatis-二-/#more">more >></a>
        
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">Mybatis</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">SpringMVC</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/28/通过项目逐步深入了解Mybatis-二-/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-通过项目逐步深入了解Mybatis-三-" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/28/通过项目逐步深入了解Mybatis-三-/">通过项目逐步深入了解Mybatis（三）</a>
    </h1>
  

        
        <a href="/2017/03/28/通过项目逐步深入了解Mybatis-三-/" class="archive-article-date">
  	<time datetime="2017-03-28T10:56:06.191Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-03-28</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>####相关阅读：<br>1、<a href="http://blog.csdn.net/tzs_1041218129/article/details/53404326">通过项目逐步深入了解Mybatis&lt;一&gt;</a></p>
<p>2、<a href="http://blog.csdn.net/tzs_1041218129/article/details/53449052"> 通过项目逐步深入了解Mybatis&lt;二&gt;</a></p>
<p>本项目所有代码及文档都托管在 Github地址：<a href="https://github.com/zhisheng17/mybatis">https://github.com/zhisheng17/mybatis</a></p>
<h3 id="如果觉得不错的话，欢迎给个-star-，-如果你想完善这个项目的话，你也可以-fork-后修改然后推送给我。"><a href="#如果觉得不错的话，欢迎给个-star-，-如果你想完善这个项目的话，你也可以-fork-后修改然后推送给我。" class="headerlink" title="如果觉得不错的话，欢迎给个 star ， 如果你想完善这个项目的话，你也可以 fork 后修改然后推送给我。"></a>如果觉得不错的话，欢迎给个 star ， 如果你想完善这个项目的话，你也可以 fork 后修改然后推送给我。</h3><h2 id="Mybatis-高级知识"><a href="#Mybatis-高级知识" class="headerlink" title="Mybatis 高级知识"></a>Mybatis 高级知识</h2><p>安排：对订单商品数据模型进行分析</p>
<h2 id="订单商品数据模型"><a href="#订单商品数据模型" class="headerlink" title="订单商品数据模型"></a>订单商品数据模型</h2><p><img src="http://ohfk1r827.bkt.clouddn.com/sql.jpg" alt=""></p>
<h3 id="数据模型分析思路："><a href="#数据模型分析思路：" class="headerlink" title="数据模型分析思路："></a>数据模型分析思路：</h3><p>1、每张表记录的数据内容（分模块对每张表记录的内容进行熟悉，相当于学习系统需求的过程）</p>
<p>2、每张表重要的的字段设置（非空字段、外键字段）</p>
<p>3、数据库级别表与表之间的关系（外键关系）</p>
<p>4、表与表业务之间的关系（要建立在每个业务意义的基础上去分析）<br>
        
          <a class="article-more-a" href="/2017/03/28/通过项目逐步深入了解Mybatis-三-/#more">more >></a>
        
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">Mybatis</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">SpringMVC</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/03/28/通过项目逐步深入了解Mybatis-三-/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 Zhisheng Tian
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="./",n(0)}([function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){var e=/\/|index.html/g;return t.replace(e,"")===n.replace(e,"")}function i(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,e=0,r=t.length;e<r;e++){var i=t[e];o(n,i.getAttribute("href"))&&(0,d.default)(i,"active")}}function u(t){for(var n=t.offsetLeft,e=t.offsetParent;null!==e;)n+=e.offsetLeft,e=e.offsetParent;return n}function f(t){for(var n=t.offsetTop,e=t.offsetParent;null!==e;)n+=e.offsetTop,e=e.offsetParent;return n}function c(t,n,e,r,o){var i=u(t),c=f(t)-n;if(c-e<=o){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,h.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(e||c)+"px",a.style.left=i+"px",a.style.zIndex=r||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");c(t,document.body.scrollTop,-63,2,0),c(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}function l(){x.default.versions.mobile&&window.screen.width<800&&(i(),s())}var p=e(71),d=r(p),v=e(72),y=(r(v),e(84)),h=r(y),b=e(69),x=r(b),m=e(75),g=r(m),w=e(70);l(),(0,w.addLoadEvent)(function(){g.default.init()}),t.exports={}},function(t,n){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,n){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},function(t,n,e){var r=e(49),o=e(15);t.exports=function(t){return r(o(t))}},function(t,n,e){t.exports=!e(8)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,e){var r=e(6),o=e(12);t.exports=e(4)?function(t,n,e){return r.f(t,n,o(1,e))}:function(t,n,e){return t[n]=e,t}},function(t,n,e){var r=e(10),o=e(30),i=e(24),u=Object.defineProperty;n.f=e(4)?Object.defineProperty:function(t,n,e){if(r(t),n=i(n,!0),r(e),o)try{return u(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},function(t,n,e){var r=e(22)("wks"),o=e(13),i=e(1).Symbol,u="function"==typeof i,f=t.exports=function(t){return r[t]||(r[t]=u&&i[t]||(u?i:o)("Symbol."+t))};f.store=r},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,e){var r=e(35),o=e(16);t.exports=Object.keys||function(t){return r(t,o)}},function(t,n,e){var r=e(11);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},function(t,n){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,e){var r=e(6).f,o=e(2),i=e(7)("toStringTag");t.exports=function(t,n,e){t&&!o(t=e?t:t.prototype,i)&&r(t,i,{configurable:!0,value:n})}},function(t,n,e){var r=e(22)("keys"),o=e(13);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,n,e){var r=e(1),o="__core-js_shared__",i=r[o]||(r[o]={});t.exports=function(t){return i[t]||(i[t]={})}},function(t,n){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(t,n,e){var r=e(11);t.exports=function(t,n){if(!r(t))return t;var e,o;if(n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;if("function"==typeof(e=t.valueOf)&&!r(o=e.call(t)))return o;if(!n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,n,e){var r=e(1),o=e(14),i=e(18),u=e(26),f=e(6).f;t.exports=function(t){var n=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==t.charAt(0)||t in n||f(n,t,{value:u.f(t)})}},function(t,n,e){n.f=e(7)},function(t,n,e){var r=e(1),o=e(14),i=e(46),u=e(5),f="prototype",c=function(t,n,e){var a,s,l,p=t&c.F,d=t&c.G,v=t&c.S,y=t&c.P,h=t&c.B,b=t&c.W,x=d?o:o[n]||(o[n]={}),m=x[f],g=d?r:v?r[n]:(r[n]||{})[f];d&&(e=n);for(a in e)s=!p&&g&&void 0!==g[a],s&&a in x||(l=s?g[a]:e[a],x[a]=d&&"function"!=typeof g[a]?e[a]:h&&s?i(l,r):b&&g[a]==l?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n[f]=t[f],n}(l):y&&"function"==typeof l?i(Function.call,l):l,y&&((x.virtual||(x.virtual={}))[a]=l,t&c.R&&m&&!m[a]&&u(m,a,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,n){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t,n,e){var r=e(11),o=e(1).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,n,e){t.exports=!e(4)&&!e(8)(function(){return 7!=Object.defineProperty(e(29)("div"),"a",{get:function(){return 7}}).a})},function(t,n,e){"use strict";var r=e(18),o=e(27),i=e(36),u=e(5),f=e(2),c=e(17),a=e(51),s=e(20),l=e(58),p=e(7)("iterator"),d=!([].keys&&"next"in[].keys()),v="@@iterator",y="keys",h="values",b=function(){return this};t.exports=function(t,n,e,x,m,g,w){a(e,n,x);var O,S,_,j=function(t){if(!d&&t in A)return A[t];switch(t){case y:return function(){return new e(this,t)};case h:return function(){return new e(this,t)}}return function(){return new e(this,t)}},P=n+" Iterator",E=m==h,M=!1,A=t.prototype,T=A[p]||A[v]||m&&A[m],L=T||j(m),N=m?E?j("entries"):L:void 0,C="Array"==n?A.entries||T:T;if(C&&(_=l(C.call(new t)),_!==Object.prototype&&(s(_,P,!0),r||f(_,p)||u(_,p,b))),E&&T&&T.name!==h&&(M=!0,L=function(){return T.call(this)}),r&&!w||!d&&!M&&A[p]||u(A,p,L),c[n]=L,c[P]=b,m)if(O={values:E?L:j(h),keys:g?L:j(y),entries:N},w)for(S in O)S in A||i(A,S,O[S]);else o(o.P+o.F*(d||M),n,O);return O}},function(t,n,e){var r=e(10),o=e(55),i=e(16),u=e(21)("IE_PROTO"),f=function(){},c="prototype",a=function(){var t,n=e(29)("iframe"),r=i.length,o="<",u=">";for(n.style.display="none",e(48).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write(o+"script"+u+"document.F=Object"+o+"/script"+u),t.close(),a=t.F;r--;)delete a[c][i[r]];return a()};t.exports=Object.create||function(t,n){var e;return null!==t?(f[c]=r(t),e=new f,f[c]=null,e[u]=t):e=a(),void 0===n?e:o(e,n)}},function(t,n,e){var r=e(35),o=e(16).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,e){var r=e(2),o=e(3),i=e(45)(!1),u=e(21)("IE_PROTO");t.exports=function(t,n){var e,f=o(t),c=0,a=[];for(e in f)e!=u&&r(f,e)&&a.push(e);for(;n.length>c;)r(f,e=n[c++])&&(~i(a,e)||a.push(e));return a}},function(t,n,e){t.exports=e(5)},function(t,n,e){var r=e(15);t.exports=function(t){return Object(r(t))}},function(t,n,e){t.exports={default:e(41),__esModule:!0}},function(t,n,e){t.exports={default:e(42),__esModule:!0}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var o=e(39),i=r(o),u=e(38),f=r(u),c="function"==typeof f.default&&"symbol"==typeof i.default?function(t){return typeof t}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":typeof t};n.default="function"==typeof f.default&&"symbol"===c(i.default)?function(t){return"undefined"==typeof t?"undefined":c(t)}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":"undefined"==typeof t?"undefined":c(t)}},function(t,n,e){e(65),e(63),e(66),e(67),t.exports=e(14).Symbol},function(t,n,e){e(64),e(68),t.exports=e(26).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,e){var r=e(3),o=e(61),i=e(60);t.exports=function(t){return function(n,e,u){var f,c=r(n),a=o(c.length),s=i(u,a);if(t&&e!=e){for(;a>s;)if(f=c[s++],f!=f)return!0}else for(;a>s;s++)if((t||s in c)&&c[s]===e)return t||s||0;return!t&&-1}}},function(t,n,e){var r=e(43);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)}}return function(){return t.apply(n,arguments)}}},function(t,n,e){var r=e(9),o=e(34),i=e(19);t.exports=function(t){var n=r(t),e=o.f;if(e)for(var u,f=e(t),c=i.f,a=0;f.length>a;)c.call(t,u=f[a++])&&n.push(u);return n}},function(t,n,e){t.exports=e(1).document&&document.documentElement},function(t,n,e){var r=e(28);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,n,e){var r=e(28);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,n,e){"use strict";var r=e(32),o=e(12),i=e(20),u={};e(5)(u,e(7)("iterator"),function(){return this}),t.exports=function(t,n,e){t.prototype=r(u,{next:o(1,e)}),i(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,e){var r=e(9),o=e(3);t.exports=function(t,n){for(var e,i=o(t),u=r(i),f=u.length,c=0;f>c;)if(i[e=u[c++]]===n)return e}},function(t,n,e){var r=e(13)("meta"),o=e(11),i=e(2),u=e(6).f,f=0,c=Object.isExtensible||function(){return!0},a=!e(8)(function(){return c(Object.preventExtensions({}))}),s=function(t){u(t,r,{value:{i:"O"+ ++f,w:{}}})},l=function(t,n){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,r)){if(!c(t))return"F";if(!n)return"E";s(t)}return t[r].i},p=function(t,n){if(!i(t,r)){if(!c(t))return!0;if(!n)return!1;s(t)}return t[r].w},d=function(t){return a&&v.NEED&&c(t)&&!i(t,r)&&s(t),t},v=t.exports={KEY:r,NEED:!1,fastKey:l,getWeak:p,onFreeze:d}},function(t,n,e){var r=e(6),o=e(10),i=e(9);t.exports=e(4)?Object.defineProperties:function(t,n){o(t);for(var e,u=i(n),f=u.length,c=0;f>c;)r.f(t,e=u[c++],n[e]);return t}},function(t,n,e){var r=e(19),o=e(12),i=e(3),u=e(24),f=e(2),c=e(30),a=Object.getOwnPropertyDescriptor;n.f=e(4)?a:function(t,n){if(t=i(t),n=u(n,!0),c)try{return a(t,n)}catch(t){}if(f(t,n))return o(!r.f.call(t,n),t[n])}},function(t,n,e){var r=e(3),o=e(33).f,i={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(t){try{return o(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==i.call(t)?f(t):o(r(t))}},function(t,n,e){var r=e(2),o=e(37),i=e(21)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,e){var r=e(23),o=e(15);t.exports=function(t){return function(n,e){var i,u,f=String(o(n)),c=r(e),a=f.length;return c<0||c>=a?t?"":void 0:(i=f.charCodeAt(c),i<55296||i>56319||c+1===a||(u=f.charCodeAt(c+1))<56320||u>57343?t?f.charAt(c):i:t?f.slice(c,c+2):(i-55296<<10)+(u-56320)+65536)}}},function(t,n,e){var r=e(23),o=Math.max,i=Math.min;t.exports=function(t,n){return t=r(t),t<0?o(t+n,0):i(t,n)}},function(t,n,e){var r=e(23),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,n,e){"use strict";var r=e(44),o=e(52),i=e(17),u=e(3);t.exports=e(31)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,e=this._i++;return!t||e>=t.length?(this._t=void 0,o(1)):"keys"==n?o(0,e):"values"==n?o(0,t[e]):o(0,[e,t[e]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(t,n){},function(t,n,e){"use strict";var r=e(59)(!0);e(31)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,e=this._i;return e>=n.length?{value:void 0,done:!0}:(t=r(n,e),this._i+=t.length,{value:t,done:!1})})},function(t,n,e){"use strict";var r=e(1),o=e(2),i=e(4),u=e(27),f=e(36),c=e(54).KEY,a=e(8),s=e(22),l=e(20),p=e(13),d=e(7),v=e(26),y=e(25),h=e(53),b=e(47),x=e(50),m=e(10),g=e(3),w=e(24),O=e(12),S=e(32),_=e(57),j=e(56),P=e(6),E=e(9),M=j.f,A=P.f,T=_.f,L=r.Symbol,N=r.JSON,C=N&&N.stringify,k="prototype",F=d("_hidden"),q=d("toPrimitive"),I={}.propertyIsEnumerable,B=s("symbol-registry"),D=s("symbols"),W=s("op-symbols"),H=Object[k],K="function"==typeof L,R=r.QObject,J=!R||!R[k]||!R[k].findChild,U=i&&a(function(){return 7!=S(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(t,n,e){var r=M(H,n);r&&delete H[n],A(t,n,e),r&&t!==H&&A(H,n,r)}:A,G=function(t){var n=D[t]=S(L[k]);return n._k=t,n},$=K&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},z=function(t,n,e){return t===H&&z(W,n,e),m(t),n=w(n,!0),m(e),o(D,n)?(e.enumerable?(o(t,F)&&t[F][n]&&(t[F][n]=!1),e=S(e,{enumerable:O(0,!1)})):(o(t,F)||A(t,F,O(1,{})),t[F][n]=!0),U(t,n,e)):A(t,n,e)},Y=function(t,n){m(t);for(var e,r=b(n=g(n)),o=0,i=r.length;i>o;)z(t,e=r[o++],n[e]);return t},Q=function(t,n){return void 0===n?S(t):Y(S(t),n)},X=function(t){var n=I.call(this,t=w(t,!0));return!(this===H&&o(D,t)&&!o(W,t))&&(!(n||!o(this,t)||!o(D,t)||o(this,F)&&this[F][t])||n)},V=function(t,n){if(t=g(t),n=w(n,!0),t!==H||!o(D,n)||o(W,n)){var e=M(t,n);return!e||!o(D,n)||o(t,F)&&t[F][n]||(e.enumerable=!0),e}},Z=function(t){for(var n,e=T(g(t)),r=[],i=0;e.length>i;)o(D,n=e[i++])||n==F||n==c||r.push(n);return r},tt=function(t){for(var n,e=t===H,r=T(e?W:g(t)),i=[],u=0;r.length>u;)!o(D,n=r[u++])||e&&!o(H,n)||i.push(D[n]);return i};K||(L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),n=function(e){this===H&&n.call(W,e),o(this,F)&&o(this[F],t)&&(this[F][t]=!1),U(this,t,O(1,e))};return i&&J&&U(H,t,{configurable:!0,set:n}),G(t)},f(L[k],"toString",function(){return this._k}),j.f=V,P.f=z,e(33).f=_.f=Z,e(19).f=X,e(34).f=tt,i&&!e(18)&&f(H,"propertyIsEnumerable",X,!0),v.f=function(t){return G(d(t))}),u(u.G+u.W+u.F*!K,{Symbol:L});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;nt.length>et;)d(nt[et++]);for(var nt=E(d.store),et=0;nt.length>et;)y(nt[et++]);u(u.S+u.F*!K,"Symbol",{for:function(t){return o(B,t+="")?B[t]:B[t]=L(t)},keyFor:function(t){if($(t))return h(B,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){J=!0},useSimple:function(){J=!1}}),u(u.S+u.F*!K,"Object",{create:Q,defineProperty:z,defineProperties:Y,getOwnPropertyDescriptor:V,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),N&&u(u.S+u.F*(!K||a(function(){var t=L();return"[null]"!=C([t])||"{}"!=C({a:t})||"{}"!=C(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!$(t)){for(var n,e,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);return n=r[1],"function"==typeof n&&(e=n),!e&&x(n)||(n=function(t,n){if(e&&(n=e.call(this,t,n)),!$(n))return n}),r[1]=n,C.apply(N,r)}}}),L[k][q]||e(5)(L[k],q,L[k].valueOf),l(L,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(t,n,e){e(25)("asyncIterator")},function(t,n,e){e(25)("observable")},function(t,n,e){e(62);for(var r=e(1),o=e(5),i=e(17),u=e(7)("toStringTag"),f=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],c=0;c<5;c++){var a=f[c],s=r[a],l=s&&s.prototype;l&&!l[u]&&o(l,u,a),i[a]=i.Array}},function(t,n){"use strict";var e={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&t.indexOf("KHTML")==-1,mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:t.indexOf("Safari")==-1,weixin:t.indexOf("MicroMessenger")==-1}}()};t.exports=e},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=e(40),i=r(o),u=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):o[t]||t}function n(t){return l[t]}var e=/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,r=/['<> "&]/g,o={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},f=/\u00a0/g,c=/<br\s*\/?>/gi,a=/\r?\n/g,s=/\s/g,l={};for(var p in o)l[o[p]]=p;return o["&apos;"]="'",l["'"]="&#39;",{encode:function(t){return t?(""+t).replace(r,n).replace(a,"<br/>").replace(s,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(c,"\n").replace(e,t).replace(f," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e+=2)n.push(String.fromCharCode("0x"+t.slice(e,e+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,e=t.length;e>n;n++)t[n]=u.encodeObject(t[n]);else if("object"==("undefined"==typeof t?"undefined":(0,i.default)(t)))for(var r in t)t[r]=u.encodeObject(t[r]);else if("string"==typeof t)return u.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=u},function(t,n){function e(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=e},function(t,n){function e(t,n){if(t.classList)t.classList.remove(n);else{var e=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(e," ")}}t.exports=e},,,function(t,n){"use strict";function e(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){var n=document.querySelectorAll(".article-entry a:not(.article-more-a)");n.forEach(function(t){t.setAttribute("target","_blank")})}var e=document.querySelector("#js-aboutme");e&&0!==e.length&&(e.innerHTML=e.innerText)}t.exports={init:e}},,,,,,,,,function(t,n){function e(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var e=t.nextSibling;return e?t.parentNode.insertBefore(n,e):t.parentNode.appendChild(n)}t.exports=e}])</script><script src="/./main.234bc0.js"></script><script>!function(){var e=function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)};e("/slider.885efe.js")}()</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友链</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Java</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">JVM</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">类加载机制</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">编码</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Filter过滤器</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Python</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">爬虫</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Pyspider</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">NIO</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">性能调优工具</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">前端</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Bootstrap</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">数据库</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Oracle</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Spring</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Spring MVC</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Hibernate JPA</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">MySQL</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">文件</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">数据结构</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">算法</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">字符串</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">旋转词</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">表达式</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">循环队列</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">IO</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Mybatis</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">SpringMVC</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            2、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: true
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://www.liaoxuefeng.com/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>廖雪峰</a>
            </li>
          
            <li class="search-li">
              <a href="http://www.ruanyifeng.com/blog/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>阮一峰</a>
            </li>
          
            <li class="search-li">
              <a href="http://coolshell.cn/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>陈皓</a>
            </li>
          
            <li class="search-li">
              <a href="http://www.cnblogs.com/webary/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>闻波</a>
            </li>
          
            <li class="search-li">
              <a href="http://blog.csdn.net/zffenger" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>冯兆峯</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">很惭愧&lt;br&gt;&lt;br&gt;只做了一点微小的工作&lt;br&gt;谢谢大家</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>