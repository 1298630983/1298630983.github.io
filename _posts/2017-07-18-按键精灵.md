---
layout: post
title:  "按键精灵"
categories: 脚本
tags: 重复点击
author: Jason
excerpt_separator: ">"
---

* 目录
{:toc}

### 多点找色脚本制作流程
> 本文参考[百度经验](http://jingyan.baidu.com/article/e4511cf3286ee52b855eaf74.html)

#### 步骤一
使用FindMultiColor命令，找到区域多点找色
![](/img/FindMultiColor.png)

#### 步骤二
知道步骤一，打开按键精灵抓抓助手
  1. 点击图像
  2. 抓多点
  3. 截屏
  4. 看到中意的点按Ctrl+1
  5. 生成代码
![](/img/steps.png)

#### 步骤三
找色范围设置为游戏窗口大小，使用GetClientRect命令。
> 注意：GetClientRect命令获取到的是窗口左上角坐标，和窗口的高度宽度。  而要确定一个找色范围，我们需要的是窗口的左上角坐标和右下角坐标。窗口的高度和宽度还需要加上左上角的坐标才是窗口的右下角坐标，
> 公式:
* 右下角x坐标=左上角x坐标+窗口宽度 
* 右下角y坐标=左上角y坐标+窗口高度

#### 步骤四
代码实现：
```
hwnd = Plugin.Window.MousePoint()//查找句柄
sRect = Plugin.Window.GetClientRect(Hwnd)//得到句柄客户区大小
MyArray = Split(sRect, "|")//分割字符串，将横纵坐标分成两个字符串
L = Clng(MyArray(0)): T = Clng(MyArray(1))//左上角坐标
W = l+Clng(MyArray(2)) : H =t+ Clng(MyArray(3))//右下角坐标
```
---
按键精灵命令大全：[点击这里](http://zy.anjian.com/?action-model-name-qmdn-itemid-174)